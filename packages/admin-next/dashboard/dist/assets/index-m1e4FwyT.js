import{u as y,j as e}from"./index-S--WvUSo.js";import{b as S,c as F,j as I}from"./react-router-dom-aSYyayiN.js";import{u as N,R as p}from"./route-focus-modal-MMx5Xnk0.js";import{u as E,F as i}from"./form-0PHaH8g8.js";import{o as O,s as u,c as R,b as P}from"./index-JzuMwgWW.js";import{u as w}from"./shipping-profiles-CJfLxZ-F.js";import{u as L,a as T}from"./shipping-options-YVduyG9u.js";import{u as V}from"./fulfillment-providers-VBjobkwb.js";import{i as B}from"./shipping-options-USxwsD_1.js";import{f as D}from"./format-provider-yygkXOZ0.js";import{p as H}from"./common-Hakaf8MH.js";import{t as b}from"./toast-4oQfF9Sm.js";import{R as f}from"./radio-group-asQL-yXP.js";import{I as M}from"./input-A29ux7yj.js";import{S as a}from"./select-Z4sV_-wF.js";import{S as k}from"./switch-VR1xZXYU.js";import{B as v}from"./button-Pc5Xo8ua.js";import{H as z}from"./heading-cSlef4Su.js";import"./react-PzSkSLoa.js";import"./react-dom-Og6--24v.js";import"./drawer-H3TI1lDZ.js";import"./index-sF0hA49A.js";import"./prompt-LzbVPZYR.js";import"./information-circle-solid-rXH6vJ5W.js";import"./label-HFq5fzpT.js";import"./tooltip-Ixyw9oT8.js";import"./stock-locations-5f5MPAbM.js";import"./x-circle-solid-rnqhxvfk.js";import"./check-circle-solid-7j4QonPK.js";import"./index-7dV3TD85.js";import"./index-Hm2Uj9Gg.js";import"./triangles-mini-HukRlWGp.js";var C=(t=>(t.FlatRate="flat",t.Calculated="calculated",t))(C||{});O({name:u().min(1),price_type:R(C),enabled_in_store:P().optional(),shipping_profile_id:u(),provider_id:u()});const q=({shippingOption:t,isReturn:j})=>{const{t:r}=y(),{handleSuccess:g}=N(),{shipping_profiles:_}=w({limit:999}),{fulfillment_providers:m=[]}=V({is_enabled:!0}),l=E({defaultValues:{name:t.name,price_type:t.price_type,enabled_in_store:B(t),shipping_profile_id:t.shipping_profile_id,provider_id:t.provider_id}}),{mutateAsync:c,isPending:h}=L(t.id),x=l.handleSubmit(async s=>{const n=t.rules.map(d=>({...H(d,["id","attribute","operator","value"])})),o=n.find(d=>d.attribute==="enabled_in_store");o?o.value=s.enabled_in_store?"true":"false":n.push({value:s.enabled_in_store?"true":"false",attribute:"enabled_in_store",operator:"eq"}),await c({name:s.name,price_type:s.price_type,shipping_profile_id:s.shipping_profile_id,provider_id:s.provider_id,rules:n},{onSuccess:()=>{b.success(r("general.success"),{dismissLabel:r("actions.close")}),g()},onError:d=>{b.error(r("general.error"),{description:d.message,dismissLabel:r("actions.close")})}})});return e.jsx(p.Form,{form:l,children:e.jsxs("form",{onSubmit:x,className:"flex flex-1 flex-col",children:[e.jsx(p.Body,{children:e.jsx("div",{className:"flex flex-col gap-y-8",children:e.jsxs("div",{className:"flex flex-col gap-y-8",children:[e.jsx(i.Field,{control:l.control,name:"price_type",render:({field:s})=>e.jsxs(i.Item,{children:[e.jsx(i.Label,{children:r("shipping.shippingOptions.create.allocation")}),e.jsx(i.Control,{children:e.jsxs(f,{...s,onValueChange:s.onChange,children:[e.jsx(f.ChoiceBox,{className:"flex-1",value:"flat",label:r("shipping.shippingOptions.create.fixed"),description:r("shipping.shippingOptions.create.fixedDescription")}),e.jsx(f.ChoiceBox,{className:"flex-1",value:"calculated",label:r("shipping.shippingOptions.create.calculated"),description:r("shipping.shippingOptions.create.calculatedDescription")})]})}),e.jsx(i.ErrorMessage,{})]})}),e.jsxs("div",{className:"grid gap-y-8 divide-y",children:[e.jsxs("div",{className:"grid gap-y-4",children:[e.jsx(i.Field,{control:l.control,name:"name",render:({field:s})=>e.jsxs(i.Item,{children:[e.jsx(i.Label,{children:r("fields.name")}),e.jsx(i.Control,{children:e.jsx(M,{...s})}),e.jsx(i.ErrorMessage,{})]})}),e.jsx(i.Field,{control:l.control,name:"shipping_profile_id",render:({field:{onChange:s,...n}})=>e.jsxs(i.Item,{children:[e.jsx(i.Label,{children:r("shipping.shippingOptions.create.profile")}),e.jsx(i.Control,{children:e.jsxs(a,{...n,onValueChange:s,children:[e.jsx(a.Trigger,{ref:n.ref,children:e.jsx(a.Value,{})}),e.jsx(a.Content,{children:(_??[]).map(o=>e.jsx(a.Item,{value:o.id,children:o.name},o.id))})]})})]})}),e.jsx(i.Field,{control:l.control,name:"provider_id",render:({field:{onChange:s,...n}})=>e.jsxs(i.Item,{children:[e.jsx(i.Label,{children:r("shipping.shippingOptions.edit.provider")}),e.jsx(i.Control,{children:e.jsxs(a,{...n,onValueChange:s,children:[e.jsx(a.Trigger,{ref:n.ref,children:e.jsx(a.Value,{})}),e.jsx(a.Content,{children:m.map(o=>e.jsx(a.Item,{value:o.id,children:D(o.id)},o.id))})]})})]})})]}),e.jsx("div",{className:"pt-6",children:e.jsx(i.Field,{control:l.control,name:"enabled_in_store",render:({field:{value:s,onChange:n,...o}})=>e.jsxs(i.Item,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i.Label,{children:r("shipping.shippingOptions.create.enable")}),e.jsx(i.Control,{children:e.jsx(k,{...o,checked:!!s,onCheckedChange:n})})]}),e.jsx(i.Hint,{className:"!mt-1",children:r("shipping.shippingOptions.create.enableDescription")}),e.jsx(i.ErrorMessage,{})]})})})]})]})})}),e.jsx(p.Footer,{children:e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(p.Close,{asChild:!0,children:e.jsx(v,{size:"small",variant:"secondary",children:r("actions.cancel")})}),e.jsx(v,{size:"small",type:"submit",isLoading:h,children:r("actions.save")})]})})]})})},ve=()=>{const{t}=y(),[j]=S(),{location_id:r,fset_id:g,zone_id:_,so_id:m}=F(),l=j.has("is_return"),{shipping_options:c,isPending:h,isError:x,error:s}=T(),n=c==null?void 0:c.find(o=>o.id===m);if(x)throw s;if(!h&&!n)throw I({message:`Shipping option with ID ${m} was not found`},404);return e.jsxs(p,{children:[e.jsx(p.Header,{children:e.jsx(z,{children:t("shipping.shippingOptions.edit.title")})}),!h&&n&&e.jsx(q,{shippingOption:n,isReturn:l})]})};export{ve as Component};

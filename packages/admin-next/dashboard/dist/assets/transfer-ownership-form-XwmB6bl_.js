import{u as m,c as z,j as e,T as p,S as I,d as M,m as Q}from"./index-S--WvUSo.js";import{u as V}from"./useInfiniteQuery-20kl54mv.js";import{l as P}from"./lodash-5s15_I2H.js";import{r as u}from"./react-PzSkSLoa.js";import{a as k,F as n}from"./form-0PHaH8g8.js";import{g as q}from"./money-amount-helpers--myf8Rla.js";import{g as A,a as B}from"./order-helpers-hEGvMzl3.js";import{C as H}from"./combobox-DjjFlb75.js";import{S as c}from"./select-Z4sV_-wF.js";import{f as U}from"./format-vrL-wy9v.js";const W=s=>"customer"in s,ne=({order:s,control:t})=>{const{t:r}=m(),[i,_]=u.useState(""),[j,N]=u.useState(""),h=W(s),T=k({control:t,name:"current_owner_id"}),x=u.useCallback(P.debounce(a=>N(a),300),[]);u.useEffect(()=>(x(i),()=>x.cancel()),[i,x]);const{customer:d,isLoading:S,isError:C,error:E}=z(T),{data:f,fetchNextPage:D,isFetchingNextPage:F}=V(["customers",j],async({pageParam:a=0})=>await Q.admin.customers.list({q:j,limit:10,offset:a,has_account:!0})),b=a=>{if(!a)return"";const{first_name:o,last_name:$,email:w}=a,g=[o,$].filter(Boolean).join(" ");return g?`${g} (${w})`:w},L=!S&&d,R=(f==null?void 0:f.pages.map(a=>a.customers.map(o=>({label:b(o),value:o.id}))).flat())||[];if(C)throw E;return e.jsxs("div",{className:"flex flex-col gap-y-8",children:[e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsx(p,{size:"small",leading:"compact",weight:"plus",children:r(h?"transferOwnership.details.order":"transferOwnership.details.draft")}),h?e.jsx(G,{order:s}):e.jsx(J,{draft:s})]}),e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsxs("div",{children:[e.jsx(p,{size:"small",leading:"compact",weight:"plus",children:r("transferOwnership.currentOwner.label")}),e.jsx(p,{size:"small",className:"text-ui-fg-subtle",children:r("transferOwnership.currentOwner.hint")})]}),L?e.jsxs(c,{defaultValue:d.id,disabled:!0,children:[e.jsx(c.Trigger,{children:e.jsx(c.Value,{})}),e.jsx(c.Content,{children:e.jsx(c.Item,{value:d.id,children:b(d)})})]}):e.jsx(I,{className:"h-8 w-full rounded-md"})]}),e.jsx(n.Field,{control:t,name:"new_owner_id",render:({field:a})=>e.jsxs(n.Item,{children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx(n.Label,{children:r("transferOwnership.newOwner.label")}),e.jsx(n.Hint,{children:r("transferOwnership.newOwner.hint")})]}),e.jsx(n.Control,{children:e.jsx(H,{...a,searchValue:i,onSearchValueChange:_,fetchNextPage:D,isFetchingNextPage:F,options:R})}),e.jsx(n.ErrorMessage,{})]})})]})},G=({order:s})=>{const{t}=m(),{label:r}=A(t,s.fulfillment_status),{label:i}=B(t,s.payment_status);return e.jsxs(v,{children:[e.jsx(l,{label:t("fields.order"),value:`#${s.display_id}`}),e.jsx(y,{date:s.created_at}),e.jsx(l,{label:t("fields.fulfillment"),value:r}),e.jsx(l,{label:t("fields.payment"),value:i}),e.jsx(O,{total:s.total||0,currencyCode:s.currency_code})]})},J=({draft:s})=>{const{t}=m();return e.jsxs(v,{children:[e.jsx(l,{label:t("fields.draft"),value:`#${s.display_id}`}),e.jsx(y,{date:s.created_at}),e.jsx(l,{label:t("fields.status"),value:t(`draftOrders.status.${s.status}`)}),e.jsx(O,{total:s.cart.total||0,currencyCode:s.cart.region.currency_code})]})},y=({date:s})=>{const{t}=m(),r=U(new Date(s),"dd MMM yyyy");return e.jsx(l,{label:t("fields.date"),value:r})},O=({total:s,currencyCode:t})=>e.jsx(l,{label:"Total",value:q(s,t)}),l=({label:s,value:t})=>e.jsxs("div",{className:"txt-compact-small grid grid-cols-2 divide-x",children:[e.jsx("div",{className:"text-ui-fg-muted px-2 py-1.5",children:s}),e.jsx("div",{className:"text-ui-fg-subtle px-2 py-1.5",children:t})]}),v=({children:s})=>e.jsx("div",{className:M("divide-y rounded-lg border"),children:s});export{ne as T};

import{u as l,j as e,a1 as j,Z as w,W as D}from"./index-S--WvUSo.js";import{A as g}from"./action-menu-olZwXQ3q.js";import{S as c}from"./section-row-f0fE6sMo.js";import{a as A}from"./addresses-d8YOe6mI.js";import{P as N}from"./pencil-square-u3fizEAQ.js";import{H as _}from"./heading-cSlef4Su.js";import{I as R}from"./inventory-item-general-section-EfbAlFRl.js";import{u as S,a as I,D as q}from"./use-data-table-TeZp00wg.js";import{f as O,g as E,u as Q,i as J}from"./inventory-EQcmxo3i.js";import{T as L}from"./trash-nTjeUaCp.js";import{u as P}from"./use-prompt-wB0F2CxI.js";import{P as o}from"./placeholder-cell-O6UVTGmQ.js";import{r as k}from"./react-PzSkSLoa.js";import{c as z}from"./index-JDlOzmVl.js";import{L as T,c as H,d as $,j as G,O as K}from"./react-router-dom-aSYyayiN.js";import{B as C}from"./button-Pc5Xo8ua.js";import{c as M,d as W}from"./reservations-e8r1gx2W.js";import{t as Z}from"./toast-4oQfF9Sm.js";import{J as b}from"./json-view-section-Dui2O31i.js";import"./react-dom-Og6--24v.js";import"./countries-QR_y0WJ_.js";import"./empty-table-content-i72rBIA2.js";import"./plus-mini-IRJECoWI.js";import"./index-1Zwdg31z.js";import"./use-date-Putn0_Ur.js";import"./format-vrL-wy9v.js";import"./date-picker-s8-9mila.js";import"./input-A29ux7yj.js";import"./minus-E5-czcFC.js";import"./x-mark-mini-aYDSd38M.js";import"./index-7dV3TD85.js";import"./index-Hm2Uj9Gg.js";import"./lodash-5s15_I2H.js";import"./label-HFq5fzpT.js";import"./command-bar-wUgfUfvQ.js";import"./prompt-LzbVPZYR.js";import"./index-sF0hA49A.js";import"./information-circle-solid-rXH6vJ5W.js";import"./x-circle-solid-rnqhxvfk.js";import"./check-circle-solid-7j4QonPK.js";import"./badge-99FyByJO.js";import"./drawer-H3TI1lDZ.js";const B=({inventoryItem:i})=>{const{t}=l();return e.jsxs(j,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(_,{level:"h2",children:t("products.attributes")}),e.jsx(g,{groups:[{actions:[{label:t("actions.edit"),to:"attributes",icon:e.jsx(N,{})}]}]})]}),e.jsx(c,{title:t("fields.height"),value:i.height}),e.jsx(c,{title:t("fields.width"),value:i.width}),e.jsx(c,{title:t("fields.length"),value:i.length}),e.jsx(c,{title:t("fields.weight"),value:i.weight}),e.jsx(c,{title:t("fields.midCode"),value:i.mid_code}),e.jsx(c,{title:t("fields.hsCode"),value:i.hs_code}),e.jsx(c,{title:t("fields.countryOfOrigin"),value:A(i.origin_country)})]})},F=({pageSize:i=20,prefix:t})=>{const s=S(["id","location_id","stocked_quantity","reserved_quantity","incoming_quantity","available_quantity","*stock_locations"],t),{reserved_quantity:r,stocked_quantity:n,available_quantity:a,...m}=s;return{searchParams:{limit:i,reserved_quantity:r?JSON.parse(r):void 0,stocked_quantity:n?JSON.parse(n):void 0,available_quantity:a?JSON.parse(a):void 0,...m},raw:s}},Y=({level:i})=>{const{t}=l(),s=P(),{mutateAsync:r}=O(i.inventory_item_id,i.location_id),n=async()=>{await s({title:t("general.areYouSure"),description:t("inventory.deleteWarning"),confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&await r()};return e.jsx(g,{groups:[{actions:[{icon:e.jsx(N,{}),label:t("actions.edit"),to:`locations/${i.location_id}`}]},{actions:[{icon:e.jsx(L,{}),label:t("actions.delete"),onClick:n}]}]})},x=z(),V=()=>{const{t:i}=l();return k.useMemo(()=>[x.accessor("stock_locations.0.name",{header:i("fields.location"),cell:({getValue:t})=>{const s=t();return s?e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:s.toString()})}):e.jsx(o,{})}}),x.accessor("reserved_quantity",{header:i("inventory.reserved"),cell:({getValue:t})=>{const s=t();return Number.isNaN(s)?e.jsx(o,{}):e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:s})})}}),x.accessor("stocked_quantity",{header:i("fields.inStock"),cell:({getValue:t})=>{const s=t();return Number.isNaN(s)?e.jsx(o,{}):e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:s})})}}),x.accessor("available_quantity",{header:i("inventory.available"),cell:({getValue:t})=>{const s=t();return Number.isNaN(s)?e.jsx(o,{}):e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:s})})}}),x.display({id:"actions",cell:({row:t})=>e.jsx(Y,{level:t.original})})],[i])},h=20,U=({inventory_item_id:i})=>{const{searchParams:t,raw:s}=F({pageSize:h}),{inventory_levels:r,count:n,isPending:a,isError:m,error:p}=E(i,{...t,fields:"*stock_locations"}),u=V(),{table:v}=I({data:r??[],columns:u,count:n,enablePagination:!0,getRowId:f=>f.id,pageSize:h});if(m)throw p;return e.jsx(q,{table:v,columns:u,pageSize:h,count:n,isLoading:a,pagination:!0,queryObject:s})},X=({inventoryItem:i})=>{const{t}=l();return e.jsxs(j,{className:"p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(_,{children:t("inventory.locationLevels")}),e.jsx(C,{size:"small",variant:"secondary",asChild:!0,children:e.jsx(T,{to:"locations",children:t("inventory.manageLocations")})})]}),e.jsx(U,{inventory_item_id:i.id})]})},ee=({reservation:i})=>{const{t}=l(),s=P(),{mutateAsync:r}=M(i.id),n=async()=>{await s({title:t("general.areYouSure"),description:t("inventory.deleteWarning"),confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&await r(void 0,{onSuccess:()=>{Z.success(t("general.success"),{dismissLabel:t("actions.close"),description:t("inventory.reservation.deleteSuccessToast")})}})};return e.jsx(g,{groups:[{actions:[{icon:e.jsx(N,{}),label:t("actions.edit"),to:`/reservations/${i.id}/edit`}]},{actions:[{icon:e.jsx(L,{}),label:t("actions.delete"),onClick:n}]}]})},d=z(),te=({sku:i})=>{const{t}=l();return k.useMemo(()=>[d.display({header:t("fields.sku"),cell:()=>e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:i})})}),d.accessor("line_item.order_id",{header:t("inventory.reservation.orderID"),cell:({getValue:s})=>{const r=s();return r?e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:r})}):e.jsx(o,{})}}),d.accessor("description",{header:t("fields.description"),cell:({getValue:s})=>{const r=s();return r?e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:r})}):e.jsx(o,{})}}),d.accessor("location.name",{header:t("inventory.reservation.location"),cell:({getValue:s})=>{const r=s();return r?e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:r})}):e.jsx(o,{})}}),d.accessor("created_at",{header:t("fields.createdAt"),cell:({getValue:s})=>{const r=s();return r?e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:r instanceof Date?r.toString():r})}):e.jsx(o,{})}}),d.display({id:"actions",cell:({row:s})=>e.jsx(ee,{reservation:s.original})})],[t])},se=({pageSize:i=20,prefix:t})=>{const s=S(["id","location_id","inventory_item_id","quantity","line_item_id","description","created_by"],t),{quantity:r,...n}=s;return{searchParams:{limit:i,quantity:r?JSON.parse(r):void 0,...n},raw:s}},y=20,ie=({inventoryItem:i})=>{const{searchParams:t,raw:s}=se({pageSize:y}),{reservations:r,count:n,isPending:a,isError:m,error:p}=W({...t,inventory_item_id:[i.id]}),u=te({sku:i.sku}),{table:v}=I({data:r??[],columns:u,count:n,enablePagination:!0,getRowId:f=>f.id,pageSize:y});if(m)throw p;return e.jsx(q,{table:v,columns:u,pageSize:y,count:n,isLoading:a,pagination:!0,queryObject:s})},re=({inventoryItem:i})=>{const{t}=l();return e.jsxs(j,{className:"p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(_,{children:t("reservations.domain")}),e.jsx(C,{size:"small",variant:"secondary",asChild:!0,children:e.jsx(T,{to:"/reservations/create",children:t("actions.create")})})]}),e.jsx(ie,{inventoryItem:i})]})},Be=()=>{const{id:i}=H(),t=$(),{inventory_item:s,isPending:r,isError:n,error:a}=Q(i,{fields:"*variants"},{initialData:t});if(r)return e.jsx("div",{children:"Loading..."});if(n||!s)throw a||G("An unknown error occurred",500);return e.jsx("div",{className:"flex flex-col gap-y-2",children:e.jsxs("div",{className:"flex flex-col gap-x-4 lg:flex-row lg:items-start",children:[e.jsxs("div",{className:"flex w-full flex-col gap-y-2",children:[e.jsx(R,{inventoryItem:s}),e.jsx(X,{inventoryItem:s}),e.jsx(re,{inventoryItem:s}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(b,{data:s})}),e.jsx(K,{})]}),e.jsxs("div",{className:"mt-2 flex w-full max-w-[100%] flex-col gap-y-2 lg:mt-0 lg:max-w-[400px]",children:[e.jsx(B,{inventoryItem:s}),e.jsx("div",{className:"lg:hidden",children:e.jsx(b,{data:s})})]})]})})},ne=i=>({queryKey:J.detail(i),queryFn:async()=>D.inventoryItems.retrieve(i,{fields:"*variants"})}),Fe=async({params:i})=>{const t=i.id,s=ne(t);return w.getQueryData(s.queryKey)??await w.fetchQuery(s)};export{Be as Component,Fe as loader};

import{u as I,j as e}from"./index-S--WvUSo.js";import{u as z,R as j}from"./route-focus-modal-MMx5Xnk0.js";import{t as B}from"./zod-jt04JUtm.js";import{u as D,F as r}from"./form-0PHaH8g8.js";import{z as l}from"./index-JzuMwgWW.js";import{r as R}from"./react-PzSkSLoa.js";import{D as _}from"./divider-GiVPCNCn.js";import{C as $}from"./combobox-DjjFlb75.js";import{C as A}from"./country-select-m4Xtwmuu.js";import{b as O,a as Q}from"./products-_PEbH1CR.js";import{c as T}from"./cast-number-oeIUIgsb.js";import{o as f}from"./validation-CjPNSdXy.js";import{I as a}from"./input-A29ux7yj.js";import{H as C}from"./heading-cSlef4Su.js";import{S as v}from"./switch-VR1xZXYU.js";import{B as F}from"./button-Pc5Xo8ua.js";import{d as U,c as G,j as J}from"./react-router-dom-aSYyayiN.js";import"./react-dom-Og6--24v.js";import"./drawer-H3TI1lDZ.js";import"./index-sF0hA49A.js";import"./prompt-LzbVPZYR.js";import"./information-circle-solid-rXH6vJ5W.js";import"./label-HFq5fzpT.js";import"./tooltip-Ixyw9oT8.js";import"./x-mark-mini-aYDSd38M.js";import"./triangles-mini-HukRlWGp.js";import"./plus-mini-IRJECoWI.js";import"./countries-QR_y0WJ_.js";import"./index-Hm2Uj9Gg.js";const K=l.object({title:l.string().min(1),material:l.string().optional(),sku:l.string().optional(),ean:l.string().optional(),upc:l.string().optional(),barcode:l.string().optional(),inventory_quantity:f,manage_inventory:l.boolean(),allow_backorder:l.boolean(),weight:f,height:f,width:f,length:f,mid_code:l.string().optional(),hs_code:l.string().optional(),origin_country:l.string().optional(),options:l.record(l.string())}),W=({product:c,variant:s,isStockAndInventoryEnabled:g=!1})=>{const{t:o}=I(),{handleSuccess:m}=z(),y=c.options.reduce((n,i)=>{const d=s.options.find(x=>x.option_id===i.id);return n[i.title]=d==null?void 0:d.value,n},{}),t=D({defaultValues:{title:s.title,material:s.material||"",sku:s.sku||"",ean:s.ean||"",upc:s.upc||"",barcode:s.barcode||"",inventory_quantity:s.inventory_quantity||"",manage_inventory:s.manage_inventory,allow_backorder:s.allow_backorder,weight:s.weight||"",height:s.height||"",width:s.width||"",length:s.length||"",mid_code:s.mid_code||"",hs_code:s.hs_code||"",origin_country:s.origin_country||"",options:y},resolver:B(K)}),{mutateAsync:b,isLoading:u}=O(c.id,s.id),w=t.handleSubmit(async n=>{const i=p=>{if(!(typeof p>"u"||p===""))return typeof p=="string"?T(p):p},{weight:d,height:x,width:h,length:E,inventory_quantity:L,allow_backorder:k,manage_inventory:M,sku:N,ean:S,upc:H,barcode:P,...q}=n,V=g?{}:{sku:N,ean:S,upc:H,barcode:P,inventory_quantity:i(L),allow_backorder:k,manage_inventory:M};await b({id:s.id,weight:i(d),height:i(x),width:i(h),length:i(E),...V,...q},{onSuccess:()=>{m()}})});return e.jsx(j.Form,{form:t,children:e.jsxs("form",{onSubmit:w,className:"flex size-full flex-col overflow-hidden",children:[e.jsxs(j.Body,{className:"flex size-full flex-col gap-y-8 overflow-auto",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(r.Field,{control:t.control,name:"title",render:({field:n})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:o("fields.title")}),e.jsx(r.Control,{children:e.jsx(a,{...n})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"material",render:({field:n})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.material")}),e.jsx(r.Control,{children:e.jsx(a,{...n})}),e.jsx(r.ErrorMessage,{})]})}),c.options.map(n=>e.jsx(r.Field,{control:t.control,name:`options.${n.title}`,render:({field:{value:i,onChange:d,...x}})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:n.title}),e.jsx(r.Control,{children:e.jsx($,{value:i,onChange:h=>{d(h)},...x,options:n.values.map(h=>({label:h.value,value:h.value}))})})]})},n.id))]}),e.jsx(_,{}),!g&&e.jsxs(R.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-y-8",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(C,{level:"h2",children:o("products.variant.inventory.header")}),e.jsx(r.Field,{control:t.control,name:"sku",render:({field:n})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.sku")}),e.jsx(r.Control,{children:e.jsx(a,{...n})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"ean",render:({field:n})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.ean")}),e.jsx(r.Control,{children:e.jsx(a,{...n})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"upc",render:({field:n})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.upc")}),e.jsx(r.Control,{children:e.jsx(a,{...n})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"barcode",render:({field:n})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.barcode")}),e.jsx(r.Control,{children:e.jsx(a,{...n})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"inventory_quantity",render:({field:n})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:o("fields.inventoryQuantity")}),e.jsx(r.Control,{children:e.jsx(a,{type:"number",...n})}),e.jsx(r.ErrorMessage,{})]})})]}),e.jsx(r.Field,{control:t.control,name:"manage_inventory",render:({field:{value:n,onChange:i,...d}})=>e.jsxs(r.Item,{children:[e.jsxs("div",{className:"flex flex-col gap-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r.Label,{children:o("products.variant.inventory.manageInventoryLabel")}),e.jsx(r.Control,{children:e.jsx(v,{checked:n,onCheckedChange:x=>i(!!x),...d})})]}),e.jsx(r.Hint,{children:o("products.variant.inventory.manageInventoryHint")})]}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"allow_backorder",render:({field:{value:n,onChange:i,...d}})=>e.jsxs(r.Item,{children:[e.jsxs("div",{className:"flex flex-col gap-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r.Label,{children:o("products.variant.inventory.allowBackordersLabel")}),e.jsx(r.Control,{children:e.jsx(v,{checked:n,onCheckedChange:x=>i(!!x),...d})})]}),e.jsx(r.Hint,{children:o("products.variant.inventory.allowBackordersHint")})]}),e.jsx(r.ErrorMessage,{})]})})]}),e.jsx(_,{})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(C,{level:"h2",children:o("products.attributes")}),e.jsx(r.Field,{control:t.control,name:"weight",render:({field:n})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.weight")}),e.jsx(r.Control,{children:e.jsx(a,{type:"number",...n})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"width",render:({field:n})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.width")}),e.jsx(r.Control,{children:e.jsx(a,{type:"number",...n})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"length",render:({field:n})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.length")}),e.jsx(r.Control,{children:e.jsx(a,{type:"number",...n})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"height",render:({field:n})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.height")}),e.jsx(r.Control,{children:e.jsx(a,{type:"number",...n})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"mid_code",render:({field:n})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.midCode")}),e.jsx(r.Control,{children:e.jsx(a,{...n})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"hs_code",render:({field:n})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.hsCode")}),e.jsx(r.Control,{children:e.jsx(a,{...n})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"origin_country",render:({field:n})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.countryOfOrigin")}),e.jsx(r.Control,{children:e.jsx(A,{...n})}),e.jsx(r.ErrorMessage,{})]})})]})]}),e.jsx(j.Footer,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(j.Close,{asChild:!0,children:e.jsx(F,{variant:"secondary",size:"small",children:o("actions.cancel")})}),e.jsx(F,{type:"submit",size:"small",isLoading:u,children:o("actions.save")})]})})]})})},Ie=()=>{const c=U(),{t:s}=I(),{id:g,variant_id:o}=G(),{product:m,isLoading:y,isError:t,error:b}=Q(g,void 0,{initialData:c==null?void 0:c.initialData}),u=m==null?void 0:m.variants.find(n=>n.id===o);if(!y&&!u)throw J({status:404,message:`Variant with ID ${o} was not found.`});const w=!y&&!!m&&!!u;if(t)throw b;return e.jsxs(j,{children:[e.jsx(j.Header,{children:e.jsx(C,{children:s("products.variant.edit.header")})}),w&&e.jsx(W,{product:m,variant:u,isStockAndInventoryEnabled:c==null?void 0:c.isStockAndInventoryEnabled})]})};export{Ie as Component};

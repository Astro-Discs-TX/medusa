import{V as C,W as _,X as F,u as j,j as s,T as a,d as f}from"./index-S--WvUSo.js";import{t as S}from"./zod-jt04JUtm.js";import{u as E,a as y,F as r}from"./form-0PHaH8g8.js";import{o as R,s as N}from"./index-JzuMwgWW.js";import{r as w}from"./react-PzSkSLoa.js";import{H as b}from"./heading-cSlef4Su.js";import{u as I,R as u}from"./route-focus-modal-MMx5Xnk0.js";import{a as T}from"./promotions-hsTHlNrt.js";import{B as v}from"./button-Pc5Xo8ua.js";import{R as h}from"./radio-group-asQL-yXP.js";import{S as m}from"./select-Z4sV_-wF.js";const B="campaigns",P=F(B),O=(e,i)=>{const{data:l,...n}=C({queryFn:()=>_.campaigns.list(e),queryKey:P.list(e),...i});return{...l,...n}},V=({campaign:e})=>{var l,n,c,t,d;const{t:i}=j();if(e)return s.jsxs(w.Fragment,{children:[s.jsxs("div",{children:[s.jsx(b,{level:"h2",className:"mb-4",children:i("campaigns.details")}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center py-1",children:[s.jsx(a,{className:"txt-small-plus font-",children:i("campaigns.fields.identifier")}),s.jsx("div",{className:"flex items-center gap-1",children:s.jsx(a,{className:"txt-small",children:e.campaign_identifier||"-"})})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center py-1",children:[s.jsx(a,{className:"txt-small-plus",children:i("fields.description")}),s.jsx("div",{className:"flex items-center gap-1",children:s.jsx(a,{className:"txt-small",children:e.description||"-"})})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center py-1",children:[s.jsx(a,{className:"txt-small-plus",children:i("campaigns.fields.start_date")}),s.jsx("div",{className:"flex items-center gap-1",children:s.jsx(a,{className:"txt-small",children:((l=e.starts_at)==null?void 0:l.toString())||"-"})})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center py-1",children:[s.jsx(a,{className:"txt-small-plus",children:i("campaigns.fields.end_date")}),s.jsx("div",{className:"flex items-center gap-1",children:s.jsx(a,{className:"txt-small",children:((n=e.ends_at)==null?void 0:n.toString())||"-"})})]})]}),s.jsxs("div",{children:[s.jsx(b,{level:"h2",className:"mb-4",children:i("campaigns.budget.details")}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center py-1",children:[s.jsx(a,{className:"txt-small-plus font-",children:i("campaigns.budget.fields.type")}),s.jsx("div",{className:"flex items-center gap-1",children:s.jsx(a,{className:"txt-small",children:((c=e.budget)==null?void 0:c.type)||"-"})})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center py-1",children:[s.jsx(a,{className:"txt-small-plus",children:i("campaigns.budget.fields.currency")}),s.jsx("div",{className:"flex items-center gap-1",children:s.jsx(a,{className:"txt-small",children:e.currency||"-"})})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center py-1",children:[s.jsx(a,{className:"txt-small-plus",children:i("campaigns.budget.fields.limit")}),s.jsx("div",{className:"flex items-center gap-1",children:s.jsx(a,{className:"txt-small",children:((t=e.budget)==null?void 0:t.limit)||"-"})})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center py-1",children:[s.jsx(a,{className:"txt-small-plus",children:i("campaigns.budget.fields.used")}),s.jsx("div",{className:"flex items-center gap-1",children:s.jsx(a,{className:"txt-small",children:((d=e.budget)==null?void 0:d.used)||"-"})})]})]})]})},A=R({campaign_id:N().optional(),existing:N().toLowerCase()}),K=({form:e,campaigns:i})=>{const{t:l}=j(),n=y({control:e.control,name:"campaign_id"}),c=i.find(t=>t.id===n);return s.jsxs("div",{className:"flex h-full flex-col gap-y-8",children:[s.jsx(r.Field,{control:e.control,name:"existing",render:({field:t})=>s.jsxs(r.Item,{children:[s.jsx(r.Label,{children:"Method"}),s.jsx(r.Control,{children:s.jsxs(h,{className:"flex-col gap-y-3",...t,value:t.value,onValueChange:t.onChange,children:[s.jsx(h.ChoiceBox,{value:"true",label:l("promotions.form.campaign.existing.title"),description:l("promotions.form.campaign.existing.description"),className:f("",{"border-2 border-ui-border-interactive":t.value==="true"})}),s.jsx(h.ChoiceBox,{value:"false",label:l("promotions.form.campaign.new.title"),description:l("promotions.form.campaign.new.description"),className:f("",{"border-2 border-ui-border-interactive":t.value==="false"}),disabled:!0})]})}),s.jsx(r.ErrorMessage,{})]})}),s.jsx(r.Field,{control:e.control,name:"campaign_id",render:({field:{onChange:t,ref:d,...g}})=>s.jsxs(r.Item,{children:[s.jsx(r.Label,{children:l("promotions.form.campaign.existing.title")}),s.jsx(r.Control,{children:s.jsxs(m,{onValueChange:t,...g,children:[s.jsx(m.Trigger,{ref:d,children:s.jsx(m.Value,{})}),s.jsx(m.Content,{children:i.map(o=>{var x;return s.jsx(m.Item,{value:o.id,children:(x=o.name)==null?void 0:x.toUpperCase()},o.id)})})]})}),s.jsx(r.ErrorMessage,{})]})}),s.jsx(V,{campaign:c})]})},X=({promotion:e,campaigns:i})=>{const{t:l}=j(),{handleSuccess:n}=I(),{campaign:c}=e,t=E({defaultValues:{campaign_id:c==null?void 0:c.id,existing:"true"},resolver:S(A)}),d=y({control:t.control,name:"campaign_id"});i.find(p=>p.id===d);const{mutateAsync:g,isPending:o}=T(e.id),x=t.handleSubmit(async p=>{await g({campaign_id:p.campaign_id},{onSuccess:()=>n()})});return s.jsx(u.Form,{form:t,children:s.jsxs("form",{onSubmit:x,className:"flex h-full flex-col",children:[s.jsx(u.Body,{children:s.jsx(K,{form:t,campaigns:i})}),s.jsx(u.Footer,{children:s.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[s.jsx(u.Close,{asChild:!0,children:s.jsx(v,{size:"small",variant:"secondary",children:l("actions.cancel")})}),s.jsx(v,{size:"small",type:"submit",isLoading:o,children:l("actions.save")})]})})]})})};export{X as A,K as a,O as u};

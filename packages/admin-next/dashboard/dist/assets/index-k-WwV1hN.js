import{u as y,ap as I,j as e}from"./index-S--WvUSo.js";import{u as D,a as m}from"./route-focus-modal-MMx5Xnk0.js";import{e as z,d as F}from"./sales-channels--fho5-f4.js";import{t as H}from"./zod-jt04JUtm.js";import{r as P}from"./react-PzSkSLoa.js";import{u as L,H as B}from"./form-0PHaH8g8.js";import{o as M,a as N,s as O}from"./index-JzuMwgWW.js";import{a as V,D as q}from"./use-data-table-TeZp00wg.js";import{f as G}from"./products-_PEbH1CR.js";import{u as Q,a as Z,b as $}from"./use-product-table-columns-k99B-kCF.js";import{t as x}from"./toast-4oQfF9Sm.js";import{B as C}from"./button-Pc5Xo8ua.js";import{C as j}from"./checkbox-8MlXzZCx.js";import{T as J}from"./tooltip-Ixyw9oT8.js";import{c as K}from"./index-JDlOzmVl.js";import{c as U}from"./react-router-dom-aSYyayiN.js";import"./react-dom-Og6--24v.js";import"./drawer-H3TI1lDZ.js";import"./index-sF0hA49A.js";import"./heading-cSlef4Su.js";import"./prompt-LzbVPZYR.js";import"./information-circle-solid-rXH6vJ5W.js";import"./label-HFq5fzpT.js";import"./empty-table-content-i72rBIA2.js";import"./plus-mini-IRJECoWI.js";import"./index-1Zwdg31z.js";import"./use-date-Putn0_Ur.js";import"./format-vrL-wy9v.js";import"./date-picker-s8-9mila.js";import"./input-A29ux7yj.js";import"./minus-E5-czcFC.js";import"./x-mark-mini-aYDSd38M.js";import"./index-7dV3TD85.js";import"./index-Hm2Uj9Gg.js";import"./lodash-5s15_I2H.js";import"./command-bar-wUgfUfvQ.js";import"./product-types-gZDu6wo-.js";import"./placeholder-cell-O6UVTGmQ.js";import"./product-cell-gRltbXZC.js";import"./thumbnail-gerN888-.js";import"./status-cell-9XExsAIG.js";import"./x-circle-solid-rnqhxvfk.js";import"./check-circle-solid-7j4QonPK.js";const W=M({product_ids:N(O()).min(1)}),f=50,X=({salesChannel:a})=>{const{t:s}=y(),{handleSuccess:t}=D(),o=L({defaultValues:{product_ids:[]},resolver:H(W)}),{setValue:c}=o,{mutateAsync:l,isPending:p}=z(a.id),[d,u]=P.useState({}),i=r=>{const n=typeof r=="function"?r(d):r,h=Object.keys(n);c("product_ids",h,{shouldDirty:!0,shouldTouch:!0}),u(n)},{searchParams:b,raw:_}=Q({pageSize:f}),{products:T,count:g,isPending:w,isError:A,error:v}=G({expand:"variants,sales_channels",...b},{placeholderData:I}),S=ee(),R=Z(["sales_channel_id"]),{table:k}=V({data:T??[],columns:S,enableRowSelection:r=>{var n;return!((n=r.original.sales_channels)!=null&&n.map(h=>h.id).includes(a.id))},enablePagination:!0,getRowId:r=>r.id,pageSize:f,count:g,rowSelection:{state:d,updater:i},meta:{salesChannelId:a.id}}),E=o.handleSubmit(async r=>{await l({product_ids:r.product_ids},{onSuccess:()=>{x.success(s("general.success"),{description:s("salesChannels.toast.update"),dismissLabel:s("actions.close")}),t()},onError:n=>x.error(s("general.error"),{description:n.message,dismissLabel:s("actions.close")})})});if(A)throw v;return e.jsx(m.Form,{form:o,children:e.jsxs("form",{onSubmit:E,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(m.Header,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[o.formState.errors.product_ids&&e.jsx(B,{variant:"error",children:o.formState.errors.product_ids.message}),e.jsx(m.Close,{asChild:!0,children:e.jsx(C,{size:"small",variant:"secondary",children:s("actions.cancel")})}),e.jsx(C,{size:"small",type:"submit",isLoading:p,children:s("actions.save")})]})}),e.jsx(m.Body,{className:"flex h-full w-full flex-col items-center divide-y overflow-y-auto",children:e.jsx(q,{table:k,count:g,columns:S,pageSize:f,isLoading:w,filters:R,orderBy:["title","status","created_at","updated_at"],queryObject:_,layout:"fill",pagination:!0,search:!0})})]})})},Y=K(),ee=()=>{const a=$(),{t:s}=y();return P.useMemo(()=>[Y.display({id:"select",header:({table:t})=>e.jsx(j,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:o=>t.toggleAllPageRowsSelected(!!o)}),cell:({row:t,table:o})=>{var u;const{salesChannelId:c}=o.options.meta,l=(u=t.original.sales_channels)==null?void 0:u.map(i=>i.id).includes(c),p=t.getIsSelected()||l,d=e.jsx(j,{checked:p,disabled:l,onCheckedChange:i=>t.toggleSelected(!!i),onClick:i=>{i.stopPropagation()}});return l?e.jsx(J,{content:s("salesChannels.productAlreadyAdded"),side:"right",children:d}):d}}),...a],[s,a])},Ge=()=>{const{id:a}=U(),{sales_channel:s,isPending:t,isError:o,error:c}=F(a);if(o)throw c;return e.jsx(m,{children:!t&&s&&e.jsx(X,{salesChannel:s})})};export{Ge as Component};

import{Y as N,W as g,u as E,i as L,j as e,T as S}from"./index-S--WvUSo.js";import{t as T}from"./zod-jt04JUtm.js";import{u as C,F as r}from"./form-0PHaH8g8.js";import{u as F,a as A,L as I}from"./react-router-dom-aSYyayiN.js";import{o as P,s as j}from"./index-JzuMwgWW.js";import{L as k}from"./logo-box-TfH3D5h8.js";import{T as B}from"./Trans-9IhttDMi.js";import{H as M}from"./heading-cSlef4Su.js";import{I as v}from"./input-A29ux7yj.js";import{B as H}from"./button-Pc5Xo8ua.js";import{A as z}from"./alert-dyv3SYtc.js";import"./react-PzSkSLoa.js";import"./react-dom-Og6--24v.js";import"./information-circle-solid-rXH6vJ5W.js";import"./label-HFq5fzpT.js";import"./tooltip-Ixyw9oT8.js";import"./motion-jlFaYIfJ.js";import"./x-mark-mini-aYDSd38M.js";import"./x-circle-solid-rnqhxvfk.js";import"./check-circle-solid-7j4QonPK.js";const K=s=>N({mutationFn:a=>g.auth.authenticate.emailPass(a),onSuccess:async(a,n,l)=>{var i;const{token:t}=a;await g.auth.login(t),(i=s==null?void 0:s.onSuccess)==null||i.call(s,a,n,l)},...s}),R=P({email:j().email(),password:j()}),ie=()=>{var c,u,d,x,f;const{t:s}=E(),a=F(),n=A(),l=((u=(c=a.state)==null?void 0:c.from)==null?void 0:u.pathname)||"/settings",t=C({resolver:T(R),defaultValues:{email:"",password:""}}),{mutateAsync:i,isPending:b}=K(),w=t.handleSubmit(async({email:o,password:y})=>{var p;try{await i({email:o,password:y}),n(l,{replace:!0})}catch(h){if(L(h)&&((p=h.response)==null?void 0:p.status)===401){t.setError("email",{type:"manual"}),t.setError("password",{type:"manual",message:s("errors.invalidCredentials")});return}t.setError("root.serverError",{type:"manual",message:s("errors.serverError")})}}),m=(f=(x=(d=t.formState.errors)==null?void 0:d.root)==null?void 0:x.serverError)==null?void 0:f.message;return e.jsx("div",{className:"bg-ui-bg-base flex min-h-dvh w-dvw items-center justify-center",children:e.jsxs("div",{className:"m-4 flex w-full max-w-[300px] flex-col items-center",children:[e.jsx(k,{className:"mb-4"}),e.jsxs("div",{className:"mb-4 flex flex-col items-center",children:[e.jsx(M,{children:s("login.title")}),e.jsx(S,{size:"small",className:"text-ui-fg-subtle text-center",children:s("login.hint")})]}),e.jsxs(r,{...t,children:[e.jsxs("form",{onSubmit:w,className:"flex w-full flex-col gap-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(r.Field,{control:t.control,name:"email",render:({field:o})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:s("fields.email")}),e.jsx(r.Control,{children:e.jsx(v,{autoComplete:"email",...o})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"password",render:({field:o})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:s("fields.password")}),e.jsx(r.Control,{children:e.jsx(v,{type:"password",autoComplete:"current-password",...o})}),e.jsx(r.ErrorMessage,{})]})})]}),e.jsx(H,{className:"w-full",type:"submit",isLoading:b,children:s("actions.continue")})]}),m&&e.jsx(z,{className:"mt-4",dismissible:!0,variant:"error",children:m})]}),e.jsx("div",{className:"my-6 h-px w-full border-b border-dotted"}),e.jsx("span",{className:"text-ui-fg-subtle txt-small",children:e.jsx(B,{i18nKey:"login.forgotPassword",components:[e.jsx(I,{to:"/reset-password",className:"text-ui-fg-interactive transition-fg hover:text-ui-fg-interactive-hover focus-visible:text-ui-fg-interactive-hover outline-none"},"reset-password-link")]})})]})})};export{ie as Component};

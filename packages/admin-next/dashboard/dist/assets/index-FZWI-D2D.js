import{u as f,j as e,d as l,T as C}from"./index-S--WvUSo.js";import{u as _,R as n}from"./route-focus-modal-MMx5Xnk0.js";import{a as N,u as F}from"./promotions-hsTHlNrt.js";import{t as S}from"./zod-jt04JUtm.js";import{u as T,a as B,F as r}from"./form-0PHaH8g8.js";import{o as E,s as u,e as j}from"./index-JzuMwgWW.js";import{P as I}from"./percentage-input-hee_tAkG.js";import{g as P}from"./currencies-bd3ADI6s.js";import{T as L}from"./Trans-9IhttDMi.js";import{R as a}from"./radio-group-asQL-yXP.js";import{I as V}from"./input-A29ux7yj.js";import{C as w}from"./currency-input-k1bgGOuE.js";import{B as v}from"./button-Pc5Xo8ua.js";import{c as M}from"./react-router-dom-aSYyayiN.js";import{H as R}from"./heading-cSlef4Su.js";import"./react-PzSkSLoa.js";import"./react-dom-Og6--24v.js";import"./drawer-H3TI1lDZ.js";import"./index-sF0hA49A.js";import"./prompt-LzbVPZYR.js";import"./information-circle-solid-rXH6vJ5W.js";import"./label-HFq5fzpT.js";import"./tooltip-Ixyw9oT8.js";import"./index-7dV3TD85.js";import"./index-Hm2Uj9Gg.js";const D=E({is_automatic:u().toLowerCase(),code:u().min(1),value_type:j(["fixed","percentage"]),value:u(),allocation:j(["each","across"])}),z=({promotion:i})=>{var x;const{t:s}=f(),{handleSuccess:c}=_(),t=T({defaultValues:{is_automatic:i.is_automatic.toString(),code:i.code,value:(x=i.application_method.value)==null?void 0:x.toString(),allocation:i.application_method.allocation,value_type:i.application_method.type},resolver:S(D)}),m=B({control:t.control,name:"value_type"})==="fixed",{mutateAsync:b,isPending:g}=N(i.id),y=t.handleSubmit(async o=>{await b({is_automatic:o.is_automatic==="true",code:o.code,application_method:{value:o.value,type:o.value_type,allocation:o.allocation}},{onSuccess:()=>{c()}})});return e.jsx(n.Form,{form:t,children:e.jsxs("form",{onSubmit:y,className:"flex h-full flex-col",children:[e.jsx(n.Body,{children:e.jsxs("div",{className:"flex h-full flex-col gap-y-8",children:[e.jsx(r.Field,{control:t.control,name:"is_automatic",render:({field:o})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:"Method"}),e.jsx(r.Control,{children:e.jsxs(a,{className:"flex-col gap-y-3",...o,value:o.value,onValueChange:o.onChange,children:[e.jsx(a.ChoiceBox,{className:l("basis-1/2",{"border-2 border-ui-border-interactive":o.value==="false"}),value:"false",label:s("promotions.form.method.code.title"),description:s("promotions.form.method.code.description")}),e.jsx(a.ChoiceBox,{className:l("basis-1/2",{"border-2 border-ui-border-interactive":o.value==="true"}),value:"true",label:s("promotions.form.method.automatic.title"),description:s("promotions.form.method.automatic.description")})]})}),e.jsx(r.ErrorMessage,{})]})}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(r.Field,{control:t.control,name:"code",render:({field:o})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:s("promotions.form.code.title")}),e.jsx(r.Control,{children:e.jsx(V,{...o})})]})}),e.jsx(C,{size:"small",leading:"compact",className:"text-ui-fg-subtle",children:e.jsx(L,{t:s,i18nKey:"promotions.form.code.description",components:[e.jsx("br",{},"break")]})})]}),e.jsx(r.Field,{control:t.control,name:"value_type",render:({field:o})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:s("promotions.fields.value_type")}),e.jsx(r.Control,{children:e.jsxs(a,{className:"flex-col gap-y-3",...o,onValueChange:o.onChange,children:[e.jsx(a.ChoiceBox,{className:l("basis-1/2",{"border-2 border-ui-border-interactive":o.value==="fixed"}),value:"fixed",label:s("promotions.form.value_type.fixed.title"),description:s("promotions.form.value_type.fixed.description")}),e.jsx(a.ChoiceBox,{className:l("basis-1/2",{"border-2 border-ui-border-interactive":o.value==="percentage"}),value:"percentage",label:s("promotions.form.value_type.percentage.title"),description:s("promotions.form.value_type.percentage.description")})]})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"value",render:({field:{onChange:o,...d}})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:s(m?"fields.amount":"fields.percentage")}),e.jsx(r.Control,{children:m?e.jsx(w,{min:0,onValueChange:o,code:"USD",symbol:P("USD"),...d,value:Number(d.value)}):e.jsx(I,{min:0,max:100,...d,value:d.value||"",onChange:h=>{o(h.target.value===""?null:h.target.value)}},"amount")}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"allocation",render:({field:o})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:s("promotions.fields.allocation")}),e.jsx(r.Control,{children:e.jsxs(a,{className:"flex-col gap-y-3",...o,onValueChange:o.onChange,children:[e.jsx(a.ChoiceBox,{className:l("basis-1/2",{"border-2 border-ui-border-interactive":o.value==="each"}),value:"each",label:s("promotions.form.allocation.each.title"),description:s("promotions.form.allocation.each.description")}),e.jsx(a.ChoiceBox,{className:l("basis-1/2",{"border-2 border-ui-border-interactive":o.value==="across"}),value:"across",label:s("promotions.form.allocation.across.title"),description:s("promotions.form.allocation.across.description")})]})}),e.jsx(r.ErrorMessage,{})]})})]})}),e.jsx(n.Footer,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(n.Close,{asChild:!0,children:e.jsx(v,{size:"small",variant:"secondary",children:s("actions.cancel")})}),e.jsx(v,{size:"small",type:"submit",isLoading:g,children:s("actions.save")})]})})]})})},me=()=>{const{id:i}=M(),{t:s}=f(),{promotion:c,isLoading:t,isError:p,error:m}=F(i);if(p)throw m;return e.jsxs(n,{children:[e.jsx(n.Header,{children:e.jsx(R,{children:s("promotions.edit.title")})}),!t&&c&&e.jsx(z,{promotion:c})]})};export{me as Component};

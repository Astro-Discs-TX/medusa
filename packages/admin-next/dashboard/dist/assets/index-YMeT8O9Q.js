import{u as F,j as e}from"./index-S--WvUSo.js";import{u as I,a as n}from"./route-focus-modal-MMx5Xnk0.js";import{r as m}from"./react-PzSkSLoa.js";import{o as A,a as B,s as L}from"./index-JzuMwgWW.js";import{t as M}from"./zod-jt04JUtm.js";import{u as H}from"./form-0PHaH8g8.js";import{a as N,D as O}from"./use-data-table-TeZp00wg.js";import{u as V,a as q}from"./use-sales-channel-table-query-O9OBIAwF.js";import{u as G}from"./use-sales-channel-table-filters-MNsQPVv0.js";import{u as Q}from"./sales-channels--fho5-f4.js";import{u as U,a as Z}from"./products-_PEbH1CR.js";import{B as S}from"./button-Pc5Xo8ua.js";import{C as g}from"./checkbox-8MlXzZCx.js";import{c as $}from"./index-JDlOzmVl.js";import{c as J}from"./react-router-dom-aSYyayiN.js";import"./react-dom-Og6--24v.js";import"./drawer-H3TI1lDZ.js";import"./index-sF0hA49A.js";import"./heading-cSlef4Su.js";import"./prompt-LzbVPZYR.js";import"./information-circle-solid-rXH6vJ5W.js";import"./label-HFq5fzpT.js";import"./tooltip-Ixyw9oT8.js";import"./empty-table-content-i72rBIA2.js";import"./plus-mini-IRJECoWI.js";import"./index-1Zwdg31z.js";import"./use-date-Putn0_Ur.js";import"./format-vrL-wy9v.js";import"./date-picker-s8-9mila.js";import"./input-A29ux7yj.js";import"./minus-E5-czcFC.js";import"./x-mark-mini-aYDSd38M.js";import"./index-7dV3TD85.js";import"./index-Hm2Uj9Gg.js";import"./lodash-5s15_I2H.js";import"./command-bar-wUgfUfvQ.js";import"./status-cell-9XExsAIG.js";import"./text-cell-OtkuJsO8.js";import"./placeholder-cell-O6UVTGmQ.js";const K=A({sales_channels:B(L()).optional()}),c=50,W=({product:a})=>{var p,h;const{t:s}=F(),{handleSuccess:o}=I(),r=H({defaultValues:{sales_channels:((p=a.sales_channels)==null?void 0:p.map(t=>t.id))??[]},resolver:M(K)}),{setValue:i}=r,x=((h=a.sales_channels)==null?void 0:h.reduce((t,f)=>(t[f.id]=!0,t),{}))??{},[l,C]=m.useState(x);m.useEffect(()=>{const t=Object.keys(l);i("sales_channels",t,{shouldDirty:!0,shouldTouch:!0})},[l,i]);const{searchParams:j,raw:y}=V({pageSize:c}),{sales_channels:b,count:u,isLoading:w,isError:P,error:_}=Q({...j},{keepPreviousData:!0}),T=G(),d=Y(),{table:k}=N({data:b??[],columns:d,count:u,enablePagination:!0,enableRowSelection:!0,rowSelection:{state:l,updater:C},getRowId:t=>t.id,pageSize:c}),{mutateAsync:E,isLoading:R}=U(a.id),v=r.handleSubmit(async t=>{const z=(t.sales_channels??[]).map(D=>({id:D}));await E({sales_channels:z},{onSuccess:()=>{o()}})});if(P)throw _;return e.jsx(n.Form,{form:r,children:e.jsxs("div",{className:"flex h-full flex-col overflow-hidden",children:[e.jsx(n.Header,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(n.Close,{asChild:!0,children:e.jsx(S,{size:"small",variant:"secondary",children:s("actions.cancel")})}),e.jsx(S,{size:"small",isLoading:R,onClick:v,children:s("actions.save")})]})}),e.jsx(n.Body,{children:e.jsx(O,{table:k,columns:d,pageSize:c,isLoading:w,count:u,filters:T,search:!0,pagination:!0,orderBy:["name","created_at","updated_at"],queryObject:y,layout:"fill"})})]})})},X=$(),Y=()=>{const a=q();return m.useMemo(()=>[X.display({id:"select",header:({table:s})=>e.jsx(g,{checked:s.getIsSomePageRowsSelected()?"indeterminate":s.getIsAllPageRowsSelected(),onCheckedChange:o=>s.toggleAllPageRowsSelected(!!o)}),cell:({row:s})=>e.jsx(g,{checked:s.getIsSelected(),onCheckedChange:o=>s.toggleSelected(!!o),onClick:o=>{o.stopPropagation()}})}),...a],[a])},He=()=>{const{id:a}=J(),{product:s,isLoading:o,isError:r,error:i}=Z(a);if(r)throw i;return e.jsx(n,{children:!o&&s&&e.jsx(W,{product:s})})};export{He as Component};

import{u as T,j as s}from"./index-S--WvUSo.js";import{u as k,a as c}from"./route-focus-modal-MMx5Xnk0.js";import{t as A}from"./zod-jt04JUtm.js";import{r as p}from"./react-PzSkSLoa.js";import{u as E}from"./form-0PHaH8g8.js";import{o as I,a as v,s as z}from"./index-JzuMwgWW.js";import{a as F,D as B}from"./use-data-table-TeZp00wg.js";import{c as D}from"./countries-QR_y0WJ_.js";import{u as L,a as H,b as M}from"./use-country-table-query-o2jH7Fmc.js";import{a as N,b as O}from"./regions-en8xSoIX.js";import{t as x}from"./toast-4oQfF9Sm.js";import{B as y}from"./button-Pc5Xo8ua.js";import{C as S}from"./checkbox-8MlXzZCx.js";import{c as V}from"./index-JDlOzmVl.js";import{c as $}from"./react-router-dom-aSYyayiN.js";import"./react-dom-Og6--24v.js";import"./drawer-H3TI1lDZ.js";import"./index-sF0hA49A.js";import"./heading-cSlef4Su.js";import"./prompt-LzbVPZYR.js";import"./information-circle-solid-rXH6vJ5W.js";import"./label-HFq5fzpT.js";import"./tooltip-Ixyw9oT8.js";import"./empty-table-content-i72rBIA2.js";import"./plus-mini-IRJECoWI.js";import"./index-1Zwdg31z.js";import"./use-date-Putn0_Ur.js";import"./format-vrL-wy9v.js";import"./date-picker-s8-9mila.js";import"./input-A29ux7yj.js";import"./minus-E5-czcFC.js";import"./x-mark-mini-aYDSd38M.js";import"./index-7dV3TD85.js";import"./index-Hm2Uj9Gg.js";import"./lodash-5s15_I2H.js";import"./command-bar-wUgfUfvQ.js";import"./x-circle-solid-rnqhxvfk.js";import"./check-circle-solid-7j4QonPK.js";const q=I({countries:v(z()).min(1)}),u=50,d="ac",G=({region:r})=>{const{t:e}=T(),{handleSuccess:i}=k(),[t,m]=p.useState({}),l=E({defaultValues:{countries:[]},resolver:A(q)}),{setValue:f}=l;p.useEffect(()=>{const o=Object.keys(t).filter(a=>t[a]);f("countries",o,{shouldDirty:!0,shouldTouch:!0})},[t,f]);const{searchParams:C,raw:b}=L({pageSize:u,prefix:d}),{countries:j,count:g}=H({countries:D.map((o,a)=>({display_name:o.display_name,name:o.name,id:a,iso_2:o.iso_2,iso_3:o.iso_3,num_code:o.num_code,region_id:null,region:{}})),...C}),h=U(),{table:_}=F({data:j||[],columns:h,count:g,enablePagination:!0,enableRowSelection:o=>{var a;return((a=r.countries)==null?void 0:a.findIndex(n=>n.iso_2===o.original.iso_2))===-1},getRowId:o=>o.iso_2,pageSize:u,rowSelection:{state:t,updater:m},prefix:d}),{mutateAsync:R,isPending:P}=N(r.id),w=l.handleSubmit(async o=>{const a=[...r.countries.map(n=>n.iso_2),...o.countries];try{await R({countries:a}),i(),x.success(e("general.success"),{description:e("regions.toast.countries"),dismissLabel:e("actions.close")})}catch(n){x.error(e("general.error"),{description:n.message,dismissLabel:e("actions.close")})}});return s.jsx(c.Form,{form:l,children:s.jsxs("form",{onSubmit:w,className:"flex h-full flex-col overflow-hidden",children:[s.jsx(c.Header,{children:s.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[s.jsx(c.Close,{asChild:!0,children:s.jsx(y,{size:"small",variant:"secondary",children:e("actions.cancel")})}),s.jsx(y,{size:"small",isLoading:P,type:"submit",children:e("actions.add")})]})}),s.jsx(c.Body,{className:"overflow-hidden",children:s.jsx(B,{table:_,columns:h,pageSize:u,count:g,search:!0,pagination:!0,layout:"fill",orderBy:["name","code"],queryObject:b,prefix:d})})]})})},Q=V(),U=()=>{const r=M();return p.useMemo(()=>[Q.display({id:"select",header:({table:e})=>s.jsx(S,{checked:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),onCheckedChange:i=>e.toggleAllPageRowsSelected(!!i)}),cell:({row:e})=>{const i=!e.getCanSelect();return s.jsx(S,{checked:e.getIsSelected()||i,disabled:i,onCheckedChange:t=>e.toggleSelected(!!t),onClick:t=>{t.stopPropagation()}})}}),...r],[r])},ve=()=>{const{id:r}=$(),{region:e,isPending:i,isError:t,error:m}=O(r,{fields:"*payment_providers"});if(t)throw m;return s.jsx(c,{children:!i&&e&&s.jsx(G,{region:e})})};export{ve as Component};

import{Z as h,aH as q,W as z,u,j as s,a1 as j,T as x,ap as E}from"./index-S--WvUSo.js";import{J as H}from"./json-view-section-Dui2O31i.js";import{a as $,f as S,d as B}from"./sales-channels--fho5-f4.js";import{A as b}from"./action-menu-olZwXQ3q.js";import{a as O,L as Q,d as W,c as F,O as G}from"./react-router-dom-aSYyayiN.js";import{P as C}from"./pencil-square-u3fizEAQ.js";import{T as v}from"./trash-nTjeUaCp.js";import{t as n}from"./toast-4oQfF9Sm.js";import{u as P}from"./use-prompt-wB0F2CxI.js";import{H as w}from"./heading-cSlef4Su.js";import{S as J}from"./status-badge-sML89E1A.js";import{r as T}from"./react-PzSkSLoa.js";import{a as K,D as M}from"./use-data-table-TeZp00wg.js";import{f as Y}from"./products-_PEbH1CR.js";import{u as Z,a as V,b as U}from"./use-product-table-columns-k99B-kCF.js";import{B as X}from"./button-Pc5Xo8ua.js";import{C as f}from"./checkbox-8MlXzZCx.js";import{c as ee}from"./index-JDlOzmVl.js";import"./react-dom-Og6--24v.js";import"./badge-99FyByJO.js";import"./drawer-H3TI1lDZ.js";import"./index-sF0hA49A.js";import"./x-mark-mini-aYDSd38M.js";import"./information-circle-solid-rXH6vJ5W.js";import"./x-circle-solid-rnqhxvfk.js";import"./check-circle-solid-7j4QonPK.js";import"./prompt-LzbVPZYR.js";import"./input-A29ux7yj.js";import"./label-HFq5fzpT.js";import"./empty-table-content-i72rBIA2.js";import"./plus-mini-IRJECoWI.js";import"./index-1Zwdg31z.js";import"./use-date-Putn0_Ur.js";import"./format-vrL-wy9v.js";import"./date-picker-s8-9mila.js";import"./minus-E5-czcFC.js";import"./index-7dV3TD85.js";import"./index-Hm2Uj9Gg.js";import"./lodash-5s15_I2H.js";import"./command-bar-wUgfUfvQ.js";import"./product-types-gZDu6wo-.js";import"./placeholder-cell-O6UVTGmQ.js";import"./product-cell-gRltbXZC.js";import"./thumbnail-gerN888-.js";import"./status-cell-9XExsAIG.js";import"./tooltip-Ixyw9oT8.js";const se=a=>({queryKey:q.detail(a),queryFn:async()=>z.salesChannels.retrieve(a)}),Xe=async({params:a})=>{const e=a.id,t=se(e);return h.getQueryData(t.queryKey)??await h.fetchQuery(t)},te=({salesChannel:a})=>{const{t:e}=u(),t=P(),i=O(),{mutateAsync:c}=$(a.id),l=async()=>{if(await t({title:e("general.areYouSure"),description:e("salesChannels.deleteSalesChannelWarning",{name:a.name}),verificationInstruction:e("general.typeToConfirm"),verificationText:a.name,confirmText:e("actions.delete"),cancelText:e("actions.cancel")}))try{await c(),i("/settings/sales-channels",{replace:!0}),n.success(e("general.success"),{description:e("salesChannels.toast.delete"),dismissLabel:e("actions.close")})}catch(m){n.error(e("general.error"),{description:m.message,dismissLabel:e("actions.close")})}};return s.jsxs(j,{className:"divide-y p-0",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsx(w,{children:a.name}),s.jsxs("div",{className:"flex items-center gap-x-2",children:[s.jsx(J,{color:a.is_disabled?"red":"green",children:e(`general.${a.is_disabled?"disabled":"enabled"}`)}),s.jsx(b,{groups:[{actions:[{icon:s.jsx(C,{}),label:e("actions.edit"),to:`/settings/sales-channels/${a.id}/edit`}]},{actions:[{icon:s.jsx(v,{}),label:e("actions.delete"),onClick:l}]}]})]})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[s.jsx(x,{size:"small",leading:"compact",weight:"plus",children:e("fields.description")}),s.jsx(x,{size:"small",leading:"compact",children:a.description||"-"})]})]})},p=10,ae=({salesChannel:a})=>{const[e,t]=T.useState({}),{searchParams:i,raw:c}=Z({pageSize:p}),{products:l,count:d,isPending:m,isError:L,error:_}=Y({...i,sales_channel_id:[a.id]},{placeholderData:E}),g=oe(),D=V(["sales_channel_id"]),{table:k}=K({data:l??[],columns:g,count:d,enablePagination:!0,enableRowSelection:!0,pageSize:p,getRowId:r=>r.id,rowSelection:{state:e,updater:t},meta:{salesChannelId:a.id}}),{mutateAsync:R}=S(a.id),A=P(),{t:o}=u(),I=async()=>{const r=Object.keys(e);await A({title:o("general.areYouSure"),description:o("salesChannels.removeProductsWarning",{count:r.length,sales_channel:a.name}),confirmText:o("actions.delete"),cancelText:o("actions.cancel")})&&await R({product_ids:r},{onSuccess:()=>{n.success(o("general.success"),{description:o("salesChannels.toast.update"),dismissLabel:o("actions.close")}),t({})},onError:N=>{n.error(o("general.error"),{description:N.message,dismissLabel:o("actions.close")})}})};if(L)throw _;return s.jsxs(j,{className:"divide-y p-0",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsx(w,{level:"h2",children:o("products.domain")}),s.jsx(Q,{to:`/settings/sales-channels/${a.id}/add-products`,children:s.jsx(X,{size:"small",variant:"secondary",children:o("general.add")})})]}),s.jsx(M,{table:k,columns:g,pageSize:p,commands:[{action:I,label:o("actions.remove"),shortcut:"r"}],count:d,pagination:!0,search:!0,filters:D,navigateTo:r=>`/products/${r.id}`,isLoading:m,orderBy:["title","variants","status","created_at","updated_at"],queryObject:c})]})},y=ee(),oe=()=>{const a=U();return T.useMemo(()=>[y.display({id:"select",header:({table:e})=>s.jsx(f,{checked:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),onCheckedChange:t=>e.toggleAllPageRowsSelected(!!t)}),cell:({row:e})=>s.jsx(f,{checked:e.getIsSelected(),onCheckedChange:t=>e.toggleSelected(!!t),onClick:t=>{t.stopPropagation()}})}),...a,y.display({id:"actions",cell:({row:e,table:t})=>{const{salesChannelId:i}=t.options.meta;return s.jsx(ie,{productId:e.original.id,salesChannelId:i})}})],[a])},ie=({salesChannelId:a,productId:e})=>{const{t}=u(),{mutateAsync:i}=S(a),c=async()=>{try{await i({product_ids:[e]}),n.success(t("general.success"),{description:t("salesChannels.toast.update"),dismissLabel:t("actions.close")})}catch(l){n.error(t("general.error"),{description:l.message,dismissLabel:t("actions.close")})}};return s.jsx(b,{groups:[{actions:[{icon:s.jsx(C,{}),label:t("actions.edit"),to:`/products/${e}`}]},{actions:[{icon:s.jsx(v,{}),label:t("actions.remove"),onClick:c}]}]})},es=()=>{const a=W(),{id:e}=F(),{sales_channel:t,isPending:i}=B(e,{initialData:a});return i||!t?s.jsx("div",{children:"Loading..."}):s.jsxs("div",{className:"flex flex-col gap-y-2",children:[s.jsx(te,{salesChannel:t}),s.jsx(ae,{salesChannel:t}),s.jsx(H,{data:t}),s.jsx(G,{})]})};export{es as Component,Xe as loader};

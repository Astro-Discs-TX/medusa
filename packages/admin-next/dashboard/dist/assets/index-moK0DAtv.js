import{u as C,j as e,T as g}from"./index-S--WvUSo.js";import{u as w,a as n}from"./route-focus-modal-MMx5Xnk0.js";import{A as c,g as T}from"./utils-OYSiQzYS.js";import{t as M}from"./zod-jt04JUtm.js";import{u as N,F as i}from"./form-0PHaH8g8.js";import{o as H,s as L}from"./index-JzuMwgWW.js";import{r as u}from"./react-PzSkSLoa.js";import{u as A}from"./api-keys-HCNnizij.js";import{t as l}from"./toast-4oQfF9Sm.js";import{I as E,E as F,a as B}from"./input-A29ux7yj.js";import{B as h}from"./button-Pc5Xo8ua.js";import{H as P}from"./heading-cSlef4Su.js";import{P as a}from"./prompt-LzbVPZYR.js";import{u as k}from"./react-router-dom-aSYyayiN.js";import"./react-dom-Og6--24v.js";import"./drawer-H3TI1lDZ.js";import"./index-sF0hA49A.js";import"./information-circle-solid-rXH6vJ5W.js";import"./label-HFq5fzpT.js";import"./tooltip-Ixyw9oT8.js";import"./sales-channels--fho5-f4.js";import"./products-_PEbH1CR.js";import"./x-circle-solid-rnqhxvfk.js";import"./check-circle-solid-7j4QonPK.js";const R=H({title:L().min(1)});function z(r){if(!r)return"";const t=r.slice(0,4),m=r.slice(-2);return`${t}${"â€¢".repeat(r.length-6)}${m}`}const I=({keyType:r})=>{const[t,m]=u.useState(null),[d,j]=u.useState(!0),{t:s}=C(),{handleSuccess:f}=w(),p=N({defaultValues:{title:""},resolver:M(R)}),{mutateAsync:y,isPending:b}=A(),v=p.handleSubmit(async x=>{await y({title:x.title,type:r},{onSuccess:({api_key:o})=>{switch(l.success(s("general.success"),{description:s("apiKeyManagement.create.successToast"),dismissLabel:s("general.close")}),r){case c.PUBLISHABLE:f(`/settings/publishable-api-keys/${o.id}`);break;case c.SECRET:m(o);break}},onError:o=>{l.error(s("general.error"),{description:o.message,dismissLabel:s("general.close")})}})}),S=()=>{t||l.error(s("general.error"),{dismissLabel:s("general.close"),description:s("apiKeyManagement.create.copySecretTokenFailure")}),navigator.clipboard.writeText((t==null?void 0:t.token)??""),l.success(s("general.success"),{description:s("apiKeyManagement.create.copySecretTokenSuccess"),dismissLabel:s("general.close")})},K=()=>{t&&f(`/settings/secret-api-keys/${t.id}`)};return e.jsxs(u.Fragment,{children:[e.jsx(n.Form,{form:p,children:e.jsxs("form",{className:"flex h-full flex-col overflow-hidden",onSubmit:v,children:[e.jsx(n.Header,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(n.Close,{asChild:!0,children:e.jsx(h,{size:"small",variant:"secondary",children:s("actions.cancel")})}),e.jsx(h,{size:"small",type:"submit",isLoading:b,children:s("actions.save")})]})}),e.jsx(n.Body,{className:"flex flex-1 flex-col overflow-hidden",children:e.jsx("div",{className:"flex flex-1 flex-col items-center overflow-y-auto",children:e.jsxs("div",{className:"flex w-full max-w-[720px] flex-col gap-y-8 px-2 py-16",children:[e.jsxs("div",{children:[e.jsx(P,{children:r===c.PUBLISHABLE?s("apiKeyManagement.create.createPublishableHeader"):s("apiKeyManagement.create.createSecretHeader")}),e.jsx(g,{size:"small",className:"text-ui-fg-subtle",children:r===c.PUBLISHABLE?s("apiKeyManagement.create.createPublishableHint"):s("apiKeyManagement.create.createSecretHint")})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsx(i.Field,{control:p.control,name:"title",render:({field:x})=>e.jsxs(i.Item,{children:[e.jsx(i.Label,{children:s("fields.title")}),e.jsx(i.Control,{children:e.jsx(E,{...x})}),e.jsx(i.ErrorMessage,{})]})})})]})})})]})}),e.jsx(a,{variant:"confirmation",open:!!t,children:e.jsxs(a.Content,{className:"w-fit max-w-[42.5%]",children:[e.jsxs(a.Header,{children:[e.jsx(a.Title,{children:s("apiKeyManagement.create.secretKeyCreatedHeader")}),e.jsx(a.Description,{children:s("apiKeyManagement.create.secretKeyCreatedHint")})]}),e.jsxs("div",{className:"flex flex-col gap-y-3 px-6 py-4",children:[e.jsxs("div",{className:"shadow-borders-base bg-ui-bg-component grid h-8 grid-cols-[1fr_32px] items-center overflow-hidden rounded-md",children:[e.jsx("div",{className:"flex items-center px-2",children:e.jsx(g,{family:"mono",size:"small",children:d?z(t==null?void 0:t.token):t==null?void 0:t.token})}),e.jsx("button",{className:"transition-fg hover:bg-ui-bg-base-hover active:bg-ui-bg-base-pressed text-ui-fg-muted active:text-ui-fg-subtle flex size-8 appearance-none items-center justify-center border-l",type:"button",onClick:()=>j(!d),children:d?e.jsx(F,{}):e.jsx(B,{})})]}),e.jsx(h,{size:"small",variant:"secondary",type:"button",className:"w-full",onClick:S,children:s("apiKeyManagement.actions.copy")})]}),e.jsx(a.Footer,{className:"border-t py-4",children:e.jsx(a.Action,{onClick:K,children:s("actions.continue")})})]})})]})},me=()=>{const{pathname:r}=k(),t=T(r);return e.jsx(n,{children:e.jsx(I,{keyType:t})})};export{me as Component};

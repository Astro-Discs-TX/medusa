import{u as k,j as t,T as v}from"./index-S--WvUSo.js";import{u as L,R as n}from"./route-focus-modal-MMx5Xnk0.js";import{u as w,F as a}from"./form-0PHaH8g8.js";import{c as I,u as F}from"./inventory-EQcmxo3i.js";import{z as h}from"./index-JzuMwgWW.js";import{t as N}from"./zod-jt04JUtm.js";import{t as g}from"./toast-4oQfF9Sm.js";import{I as S}from"./input-A29ux7yj.js";import{B as _}from"./button-Pc5Xo8ua.js";import{a as z}from"./stock-locations-5f5MPAbM.js";import{c as A}from"./react-router-dom-aSYyayiN.js";import{H as R}from"./heading-cSlef4Su.js";import"./react-PzSkSLoa.js";import"./react-dom-Og6--24v.js";import"./drawer-H3TI1lDZ.js";import"./index-sF0hA49A.js";import"./prompt-LzbVPZYR.js";import"./information-circle-solid-rXH6vJ5W.js";import"./label-HFq5fzpT.js";import"./tooltip-Ixyw9oT8.js";import"./x-circle-solid-rnqhxvfk.js";import"./check-circle-solid-7j4QonPK.js";const c=({title:o,value:s})=>t.jsxs("div",{className:"grid grid-cols-2 divide-x",children:[t.jsx(v,{className:"px-2 py-1.5",size:"small",leading:"compact",children:o}),t.jsx(v,{className:"px-2 py-1.5",size:"small",leading:"compact",children:s})]}),C=({item:o,level:s,location:u})=>{const{t:e}=k(),{handleSuccess:l}=L(),x=h.object({stocked_quantity:h.number().min(s.reserved_quantity)}),r=w({defaultValues:{stocked_quantity:s.stocked_quantity},resolver:N(x)}),d=r.watch("stocked_quantity"),{mutateAsync:m,isPending:p}=I(o.id,s.location_id),y=r.handleSubmit(async i=>{if(i.stocked_quantity===s.stocked_quantity)return l();try{await m({stocked_quantity:i.stocked_quantity}),g.success(e("general.success"),{description:e("inventory.toast.updateLevel"),dismissLabel:e("actions.close")})}catch(f){g.error(e("general.error"),{description:f.message,dismissLabel:e("actions.close")})}return l()});return t.jsx(n.Form,{form:r,children:t.jsxs("form",{onSubmit:y,className:"flex flex-1 flex-col overflow-hidden",children:[t.jsxs(n.Body,{className:"flex flex-1 flex-col gap-y-8 overflow-auto",children:[t.jsxs("div",{className:"text-ui-fg-subtle shadow-elevation-card-rest grid grid-rows-4 divide-y rounded-lg border",children:[t.jsx(c,{title:e("fields.title"),value:o.title??"-"}),t.jsx(c,{title:e("fields.sku"),value:o.sku}),t.jsx(c,{title:e("locations.domain"),value:u.name}),t.jsx(c,{title:e("inventory.reserved"),value:s.reserved_quantity}),t.jsx(c,{title:e("inventory.available"),value:d-s.reserved_quantity})]}),t.jsx(a.Field,{control:r.control,name:"stocked_quantity",render:({field:{onChange:i,value:f,...b}})=>t.jsxs(a.Item,{children:[t.jsx(a.Label,{children:e("fields.inStock")}),t.jsx(a.Control,{children:t.jsx(S,{type:"number",min:s.reserved_quantity,value:f||"",onChange:q=>{const j=q.target.value;i(j===""?null:parseFloat(j))},...b})}),t.jsx(a.ErrorMessage,{})]})})]}),t.jsx(n.Footer,{children:t.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[t.jsx(n.Close,{asChild:!0,children:t.jsx(_,{variant:"secondary",size:"small",children:e("actions.cancel")})}),t.jsx(_,{type:"submit",size:"small",isLoading:p,children:e("actions.save")})]})})]})})},ot=()=>{const{id:o,location_id:s}=A(),{t:u}=k(),{inventory_item:e,isPending:l,isError:x,error:r}=F(o),d=e==null?void 0:e.location_levels.find(i=>i.location_id===s),{stock_location:m,isLoading:p}=z(s),y=!l&&e&&d&&!p&&m;if(x)throw r;return t.jsxs(n,{children:[t.jsx(n.Header,{children:t.jsx(R,{children:u("inventory.manageLocations")})}),y&&t.jsx(C,{item:e,level:d,location:m})]})};export{ot as Component};

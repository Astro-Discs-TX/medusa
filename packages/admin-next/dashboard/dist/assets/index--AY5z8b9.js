import{bx as L,u as n,j as e,a1 as d,T as l,by as M,am as H}from"./index-S--WvUSo.js";import{J as R}from"./json-view-section-Dui2O31i.js";import{p as A}from"./index-zCI1L4vn.js";import{r as o}from"./react-PzSkSLoa.js";import{A as p}from"./action-menu-olZwXQ3q.js";import{g as I,f as V}from"./format-vrL-wy9v.js";import{P as u}from"./pencil-square-u3fizEAQ.js";import{H as f}from"./heading-cSlef4Su.js";import{P as m,g as k}from"./discounts-t0ZvwkYf.js";import{a as B,d as $,c as G,O as U}from"./react-router-dom-aSYyayiN.js";import{T as J}from"./trash-nTjeUaCp.js";import{u as W}from"./use-prompt-wB0F2CxI.js";import{S as q}from"./status-badge-sML89E1A.js";import{L as S}from"./list-summary-5vNt7oxx.js";import{M as F}from"./money-amount-cell-qk7EOos5.js";import{C as K}from"./copy-jbaNBJoS.js";import{N as X}from"./empty-table-content-i72rBIA2.js";import{T as Y}from"./Trans-9IhttDMi.js";import{B as b}from"./badge-99FyByJO.js";import{e as Z}from"./loader-ap67xDAw.js";import{d as Xe}from"./loader-ap67xDAw.js";import"./react-dom-Og6--24v.js";import"./drawer-H3TI1lDZ.js";import"./index-sF0hA49A.js";import"./x-mark-mini-aYDSd38M.js";import"./prompt-LzbVPZYR.js";import"./button-Pc5Xo8ua.js";import"./input-A29ux7yj.js";import"./label-HFq5fzpT.js";import"./tooltip-Ixyw9oT8.js";import"./money-amount-helpers--myf8Rla.js";import"./currencies-bd3ADI6s.js";import"./placeholder-cell-O6UVTGmQ.js";import"./check-circle-solid-7j4QonPK.js";import"./plus-mini-IRJECoWI.js";var Q=Object.defineProperty,x=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,w=(s,t,i)=>t in s?Q(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,ee=(s,t)=>{for(var i in t||(t={}))C.call(t,i)&&w(s,i,t[i]);if(x)for(var i of x(t))O.call(t,i)&&w(s,i,t[i]);return s},se=(s,t)=>{var i={};for(var a in s)C.call(s,a)&&t.indexOf(a)<0&&(i[a]=s[a]);if(s!=null&&x)for(var a of x(s))t.indexOf(a)<0&&O.call(s,a)&&(i[a]=s[a]);return i};const P=o.forwardRef((s,t)=>{var i=s,{color:a="currentColor"}=i,c=se(i,["color"]);return o.createElement("svg",ee({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none",ref:t},c),o.createElement("path",{stroke:a,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16.815 9.7v6.6c0 .318-.125.623-.347.848a1.178 1.178 0 0 1-.838.352H4.37c-.314 0-.615-.126-.838-.352a1.207 1.207 0 0 1-.347-.848V9.7m6.519-5.1c0-.415-.122-.821-.35-1.167a2.08 2.08 0 0 0-.93-.773 2.05 2.05 0 0 0-2.261.455 2.124 2.124 0 0 0-.45 2.289c.157.383.423.711.764.942.341.23.742.354 1.153.354h2.074m0-2.1v2.1m0-2.1c0-.415.121-.821.35-1.167a2.08 2.08 0 0 1 .93-.773 2.05 2.05 0 0 1 2.26.455 2.124 2.124 0 0 1 .45 2.289 2.095 2.095 0 0 1-.764.942c-.341.23-.742.354-1.152.354H9.704m0 0v10.8M2.889 9.7H17.11c.49 0 .889-.403.889-.9V7.6c0-.497-.398-.9-.889-.9H2.89A.895.895 0 0 0 2 7.6v1.2c0 .497.398.9.889.9Z"}))});P.displayName="Gift";const te=["years","months","weeks","days","hours","minutes","seconds"];function ie(s,t){const i=I(),a=(t==null?void 0:t.locale)??i.locale??L,c=(t==null?void 0:t.format)??te,r=(t==null?void 0:t.zero)??!1,g=(t==null?void 0:t.delimiter)??" ";return a.formatDistance?c.reduce((h,j)=>{const T=`x${j.replace(/(^.)/,E=>E.toUpperCase())}`,N=s[j];return N!==void 0&&(r||s[j])?h.concat(a.formatDistance(T,N)):h},[]).join(g):""}function z(s){return s?V(new Date(s),"dd MMM, yyyy, HH:mm:ss"):"-"}const ae=({discount:s})=>{const{t}=n(),i=o.useMemo(()=>s.valid_duration?ie(A(s.valid_duration)):"-",[s.valid_duration]);return e.jsxs(d,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(f,{children:t("fields.configurations")})}),e.jsx(p,{groups:[{actions:[{icon:e.jsx(u,{}),label:t("actions.edit"),to:"configuration"}]}]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(l,{size:"small",weight:"plus",leading:"compact",children:t("discounts.startDate")}),e.jsx(l,{size:"small",leading:"compact",className:"text-pretty",children:z(s.starts_at)})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(l,{size:"small",weight:"plus",leading:"compact",children:t("discounts.endDate")}),e.jsx(l,{size:"small",leading:"compact",className:"text-pretty",children:z(s.ends_at)})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(l,{size:"small",weight:"plus",leading:"compact",children:t("discounts.redemptionsLimit")}),e.jsx(l,{size:"small",leading:"compact",className:"text-pretty",children:s.usage_limit||"-"})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(l,{size:"small",weight:"plus",leading:"compact",children:t("discounts.validDuration")}),e.jsx(l,{size:"small",leading:"compact",className:"text-pretty",children:i})]})]})},le=({discount:s})=>{const{t}=n(),i=W(),a=B(),{mutateAsync:c}=M(s.id),r=async()=>{await i({title:t("general.areYouSure"),description:t("discounts.deleteWarning",{code:s.code}),verificationInstruction:t("general.typeToConfirm"),verificationText:s.code,confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&await c(void 0,{onSuccess:()=>{a("/discounts",{replace:!0})}})},[g,y]={[m.DISABLED]:["grey",t("discounts.discountStatus.disabled")],[m.ACTIVE]:["green",t("discounts.discountStatus.active")],[m.SCHEDULED]:["orange",t("discounts.discountStatus.scheduled")],[m.EXPIRED]:["red",t("discounts.discountStatus.expired")]}[k(s)];return e.jsxs(d,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(f,{children:s.code})}),e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(q,{color:g,children:y}),e.jsx(p,{groups:[{actions:[{icon:e.jsx(u,{}),label:t("actions.edit"),to:`/discounts/${s.id}/edit`}]},{actions:[{icon:e.jsx(J,{}),label:t("actions.delete"),onClick:r}]}]})]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(l,{size:"small",weight:"plus",leading:"compact",children:t("fields.description")}),e.jsx(l,{size:"small",leading:"compact",className:"text-pretty",children:s.rule.description||"-"})]})]})},_=({discount:s})=>{var i;const{t}=n();return e.jsxs(d,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(f,{level:"h2",children:t("general.details")}),e.jsx(p,{groups:[{actions:[{label:t("actions.edit"),to:"edit",icon:e.jsx(u,{})}]}]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(l,{size:"small",weight:"plus",leading:"compact",children:t("fields.code")}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(l,{size:"small",weight:"plus",leading:"compact",className:"text-ui-fg-base text-pretty",children:s.code}),e.jsx(K,{content:s.code,variant:"mini"})]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(l,{size:"small",weight:"plus",leading:"compact",children:t("fields.type")}),e.jsx(l,{size:"small",leading:"compact",className:"text-pretty",children:s.rule.type==="percentage"?t("discounts.percentageDiscount"):s.rule.type==="free_shipping"?t("discounts.freeShipping"):t("discounts.fixedDiscount")})]}),s.rule.type==="percentage"&&e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(l,{size:"small",weight:"plus",leading:"compact",children:t("fields.value")}),e.jsx(l,{size:"small",leading:"compact",className:"text-pretty",children:s.rule.value})]}),s.rule.type==="fixed"&&e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(l,{size:"small",weight:"plus",leading:"compact",children:t("fields.amount")}),e.jsx(l,{size:"small",className:"text-pretty",children:e.jsx(F,{currencyCode:(i=s.regions[0])==null?void 0:i.currency_code,amount:s.rule.value})})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(l,{size:"small",weight:"plus",leading:"compact",children:t("discounts.validRegions")}),e.jsx(l,{size:"small",className:"text-pretty",children:e.jsx(S,{list:s.regions.map(a=>a.name)})})]})]})},v=1,re=s=>s.title!==void 0,ce=s=>s.name!==void 0,ne=s=>s.value!==void 0;function oe({condition:s}){const{t}=n(),i=s.operator==="in"?"including":"excluding",a=s.type,c=s[a].map(r=>{if(re(r))return r.title;if(ce(r))return r.name;if(ne(r))return r.value});return e.jsx("div",{className:"bg-ui-bg-subtle shadow-borders-base flex justify-around rounded-md p-2",children:e.jsx("span",{className:"text-ui-fg-subtle txt-compact-xsmall whitespace-nowrap",children:e.jsx(Y,{t,count:s[a].length>v?v-s[a].length:s[a].length,i18nKey:`discounts.conditions.${i}.${a}`,components:[e.jsx(b,{size:"2xsmall",className:"mx-1 max-w-[120px]",children:e.jsx(S,{inline:!0,n:v,list:c,className:"!txt-compact-xsmall-plus"})},"discounts-incl"),e.jsx(b,{size:"2xsmall",className:"mx-1"},"discounts-excl")]})})})}const de=({discount:s})=>{const{t}=n(),i=o.useMemo(()=>s.rule.conditions.sort((a,c)=>a.type.localeCompare(c.type)),[s]);return e.jsxs(d,{className:"p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(f,{children:t("fields.conditions")})}),e.jsx(p,{groups:[{actions:[{icon:e.jsx(u,{}),label:t("actions.edit"),to:"conditions"}]}]})]}),e.jsxs("div",{className:"text-ui-fg-subtle flex flex-col gap-2 px-6 pb-4 pt-2",children:[!i.length&&e.jsx(X,{className:"h-[180px]"}),i.map(a=>e.jsx(oe,{condition:a},a.id))]})]})},D=({redemptions:s})=>{const{t}=n();return e.jsxs(d,{className:"flex flex-col gap-y-6 px-6 py-4",children:[e.jsxs("div",{className:"grid grid-cols-[28px_1fr] items-center gap-x-3",children:[e.jsx("div",{className:"bg-ui-bg-base shadow-borders-base flex size-7 items-center justify-center rounded-md",children:e.jsx("div",{className:"bg-ui-bg-component flex size-6 items-center justify-center rounded-[4px]",children:e.jsx(P,{className:"text-ui-fg-subtle"})})}),e.jsx(l,{className:"text-ui-fg-subtle",weight:"plus",size:"small",leading:"compact",children:t("fields.totalRedemptions")})]}),e.jsx("div",{className:"border-ui-fg-muted border-l-2 pl-2",children:e.jsx(l,{className:"text-ui-fg-base leading-[100%]",weight:"plus",size:"xlarge",children:s})})]})},me={widgets:[]},xe={widgets:[]},qe=()=>{const s=$(),{id:t}=G(),{discount:i,isLoading:a}=H(t,{expand:Z},{initialData:s});return a||!i?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{className:"flex flex-col gap-y-2",children:[xe.widgets.map((c,r)=>e.jsx("div",{children:e.jsx(c.Component,{})},r)),e.jsxs("div",{className:"flex flex-col gap-x-4 xl:flex-row xl:items-start",children:[e.jsxs("div",{className:"flex w-full flex-col gap-y-2",children:[e.jsx(le,{discount:i}),e.jsx(ae,{discount:i}),e.jsx(de,{discount:i}),e.jsxs("div",{className:"flex w-full flex-col gap-y-2 xl:hidden",children:[e.jsx(D,{redemptions:i.usage_count}),e.jsx(_,{discount:i})]}),me.widgets.map((c,r)=>e.jsx("div",{children:e.jsx(c.Component,{})},r)),e.jsx(R,{data:i})]}),e.jsxs("div",{className:"hidden w-full max-w-[400px] flex-col gap-y-2 xl:flex",children:[e.jsx(D,{redemptions:i.usage_count}),e.jsx(_,{discount:i})]})]}),e.jsx(U,{})]})};export{qe as Component,Xe as loader};

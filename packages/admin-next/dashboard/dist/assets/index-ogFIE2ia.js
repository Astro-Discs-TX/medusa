import{u as j,at as z,j as e,ap as F,an as H}from"./index-S--WvUSo.js";import{u as L,a as n}from"./route-focus-modal-MMx5Xnk0.js";import{r as C}from"./react-PzSkSLoa.js";import{o as N,a as _,s as B}from"./index-JzuMwgWW.js";import{t as M}from"./zod-jt04JUtm.js";import{u as O,H as U}from"./form-0PHaH8g8.js";import{a as V,D as q}from"./use-data-table-TeZp00wg.js";import{u as G}from"./currencies--m0OMbks.js";import{u as Q,a as X}from"./use-currencies-table-query-HIAX2jYr.js";import{t as x}from"./toast-4oQfF9Sm.js";import{B as g}from"./button-Pc5Xo8ua.js";import{C as S}from"./checkbox-8MlXzZCx.js";import{T as Z}from"./tooltip-Ixyw9oT8.js";import{c as $}from"./index-JDlOzmVl.js";import"./react-dom-Og6--24v.js";import"./react-router-dom-aSYyayiN.js";import"./drawer-H3TI1lDZ.js";import"./index-sF0hA49A.js";import"./heading-cSlef4Su.js";import"./prompt-LzbVPZYR.js";import"./information-circle-solid-rXH6vJ5W.js";import"./label-HFq5fzpT.js";import"./empty-table-content-i72rBIA2.js";import"./plus-mini-IRJECoWI.js";import"./index-1Zwdg31z.js";import"./use-date-Putn0_Ur.js";import"./format-vrL-wy9v.js";import"./date-picker-s8-9mila.js";import"./input-A29ux7yj.js";import"./minus-E5-czcFC.js";import"./x-mark-mini-aYDSd38M.js";import"./index-7dV3TD85.js";import"./index-Hm2Uj9Gg.js";import"./lodash-5s15_I2H.js";import"./command-bar-wUgfUfvQ.js";import"./x-circle-solid-rnqhxvfk.js";import"./check-circle-solid-7j4QonPK.js";const J=N({currencies:_(B()).min(1)}),y=50,u="ac",K=({store:i})=>{const{t:s}=j(),{handleSuccess:t}=L(),r=O({defaultValues:{currencies:[]},resolver:M(J)}),{setValue:m}=r,[c,a]=C.useState({}),b=o=>{const l=typeof o=="function"?o(c):o,d=Object.keys(l);m("currencies",d,{shouldDirty:!0,shouldTouch:!0}),a(l)},{raw:w,searchParams:P}=Q({pageSize:50,prefix:u}),{currencies:R,count:p,isPending:T,isError:v,error:A}=G(P,{placeholderData:F}),f=i.supported_currency_codes.map(o=>o),h=Y(),{table:k}=V({data:R??[],columns:h,count:p,getRowId:o=>o.code,enableRowSelection:o=>!f.includes(o.original.code),enablePagination:!0,pageSize:y,prefix:u,rowSelection:{state:c,updater:b}}),{mutateAsync:E,isPending:D}=z(i.id),I=r.handleSubmit(async o=>{const l=Array.from(new Set([...o.currencies,...f]));try{await E({supported_currency_codes:l}),x.success(s("general.success"),{description:s("store.toast.currenciesUpdated"),dismissLabel:s("actions.close")}),t()}catch(d){x.error(s("general.error"),{description:d.message,dismissLabel:s("actions.close")})}});if(v)throw A;return e.jsx(n.Form,{form:r,children:e.jsxs("form",{onSubmit:I,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(n.Header,{children:e.jsxs("div",{className:"flex flex-1 items-center justify-between",children:[e.jsx("div",{className:"flex items-center",children:r.formState.errors.currencies&&e.jsx(U,{variant:"error",children:r.formState.errors.currencies.message})}),e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(n.Close,{asChild:!0,children:e.jsx(g,{size:"small",variant:"secondary",children:s("actions.cancel")})}),e.jsx(g,{size:"small",type:"submit",isLoading:D,children:s("actions.save")})]})]})}),e.jsx(n.Body,{className:"flex flex-1 flex-col overflow-hidden",children:e.jsx(q,{table:k,pageSize:y,count:p,columns:h,layout:"fill",pagination:!0,search:!0,prefix:u,orderBy:["code","name"],isLoading:T,queryObject:w})})]})})},W=$(),Y=()=>{const{t:i}=j(),s=X();return C.useMemo(()=>[W.display({id:"select",header:({table:t})=>e.jsx(S,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:r=>t.toggleAllPageRowsSelected(!!r)}),cell:({row:t})=>{const r=!t.getCanSelect(),m=t.getIsSelected()||r,c=e.jsx(S,{checked:m,disabled:r,onCheckedChange:a=>t.toggleSelected(!!a),onClick:a=>{a.stopPropagation()}});return r?e.jsx(Z,{content:i("store.currencyAlreadyAdded"),side:"right",children:c}):c}}),...s],[i,s])},Ne=()=>{const{store:i,isPending:s,isError:t,error:r}=H();if(t)throw r;return e.jsx(n,{children:!s&&i&&e.jsx(K,{store:i})})};export{Ne as Component};

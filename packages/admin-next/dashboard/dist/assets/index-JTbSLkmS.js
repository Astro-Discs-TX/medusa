import{u as N,aK as D,j as s,a1 as O,T as a,a9 as z,Z as f,aH as P,m as S}from"./index-S--WvUSo.js";import{J as $}from"./json-view-section-Dui2O31i.js";import{f as h}from"./format-vrL-wy9v.js";import{a as L,L as j,c as M,d as A,O as E}from"./react-router-dom-aSYyayiN.js";import{A as T}from"./action-menu-olZwXQ3q.js";import{c as q}from"./currencies-bd3ADI6s.js";import{b as y}from"./money-amount-helpers--myf8Rla.js";import{P as B}from"./pencil-square-u3fizEAQ.js";import{T as G}from"./trash-nTjeUaCp.js";import{r as p}from"./react-PzSkSLoa.js";import{u as R}from"./use-prompt-wB0F2CxI.js";import{H as k}from"./heading-cSlef4Su.js";import{C as H}from"./copy-jbaNBJoS.js";import{S as K}from"./status-badge-sML89E1A.js";import"./react-dom-Og6--24v.js";import"./badge-99FyByJO.js";import"./drawer-H3TI1lDZ.js";import"./index-sF0hA49A.js";import"./x-mark-mini-aYDSd38M.js";import"./prompt-LzbVPZYR.js";import"./button-Pc5Xo8ua.js";import"./input-A29ux7yj.js";import"./label-HFq5fzpT.js";import"./tooltip-Ixyw9oT8.js";import"./check-circle-solid-7j4QonPK.js";var Q=Object.defineProperty,l=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable,v=(e,t,i)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,U=(e,t)=>{for(var i in t||(t={}))w.call(t,i)&&v(e,i,t[i]);if(l)for(var i of l(t))_.call(t,i)&&v(e,i,t[i]);return e},I=(e,t)=>{var i={};for(var r in e)w.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&l)for(var r of l(e))t.indexOf(r)<0&&_.call(e,r)&&(i[r]=e[r]);return i};const x=p.forwardRef((e,t)=>{var i=e,{color:r="currentColor"}=i,n=I(i,["color"]);return p.createElement("svg",U({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none",ref:t},n),p.createElement("path",{stroke:r,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.054 5.327H4.743A1.752 1.752 0 0 0 2.99 7.079v8.178a1.752 1.752 0 0 0 1.753 1.753h8.178a1.752 1.752 0 0 0 1.752-1.753v-4.236m-7.67 1.993L17.01 2.99m0 0h-4.09m4.09 0v4.09"}))});x.displayName="ArrowUpRightOnBox";const J=({giftCard:e})=>{var g;const{t}=N(),i=R(),r=L(),{mutateAsync:n}=D(e.id),c=async()=>{await i({title:t("general.areYouSure"),description:t("giftCards.deleteGiftCardWarning",{code:e.code}),confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&await n(void 0,{onSuccess:()=>{r("..")}})};let d;e.is_disabled||e.ends_at&&new Date(e.ends_at)<new Date?d="red":d="green";let m=t("general.enabled");e.is_disabled&&(m=t("general.disabled")),e.ends_at&&new Date(e.ends_at)<new Date&&(m=t("general.expired"));const b=(g=e.metadata)==null?void 0:g.email,o=e.region.currency_code.toUpperCase(),u=q[o].symbol_native;return s.jsxs(O,{className:"divide-y p-0",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsxs("div",{className:"flex items-center gap-x-2",children:[s.jsx(k,{children:e.code}),s.jsx(H,{content:e.code,className:"text-ui-fg-muted"})]}),s.jsxs("div",{className:"flex items-center gap-x-2",children:[s.jsx(K,{color:d,children:m}),s.jsx(T,{groups:[{actions:[{icon:s.jsx(B,{}),label:t("actions.edit"),to:"edit"}]},{actions:[{label:t("actions.delete"),icon:s.jsx(G,{}),onClick:c}]}]})]})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[s.jsx(a,{size:"small",leading:"compact",weight:"plus",children:t("giftCards.currentBalance")}),s.jsx(a,{size:"small",leading:"compact",children:`${u} ${y(e.balance,o)} ${o}`})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[s.jsx(a,{size:"small",leading:"compact",weight:"plus",children:t("giftCards.initialBalance")}),s.jsx(a,{size:"small",leading:"compact",children:`${u} ${y(e.value,o)} ${o}`})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[s.jsx(a,{size:"small",leading:"compact",weight:"plus",children:t("giftCards.recipient")}),s.jsx(a,{size:"small",leading:"compact",children:b??"-"})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[s.jsx(a,{size:"small",leading:"compact",weight:"plus",children:t("fields.region")}),s.jsxs(j,{to:`/settings/regions/${e.region.id}`,className:"txt-compact-small text-ui-fg-interactive hover:text-ui-fg-interactive-hover transition-fg focus:shadow-borders-focus flex w-fit items-center gap-x-1.5 rounded-[4px] outline-none",children:[s.jsx("span",{children:e.region.name}),s.jsx(x,{})]})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[s.jsx(a,{size:"small",leading:"compact",weight:"plus",children:t("fields.order")}),e.order?s.jsxs(j,{to:`/orders/${e.order.id}`,className:"txt-compact-small text-ui-fg-interactive hover:text-ui-fg-interactive-hover transition-fg focus:shadow-borders-focus flex w-fit items-center gap-x-1.5 rounded-[4px] outline-none",children:[s.jsx("span",{children:`#${e.order.display_id}`}),s.jsx(x,{})]}):s.jsx(a,{size:"small",leading:"compact",children:"-"})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[s.jsx(a,{size:"small",leading:"compact",weight:"plus",children:t("fields.issuedDate")}),s.jsx(a,{size:"small",leading:"compact",children:h(new Date(e.created_at),"dd MMM yyyy")})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[s.jsx(a,{size:"small",leading:"compact",weight:"plus",children:t("fields.expiryDate")}),s.jsx(a,{size:"small",leading:"compact",children:e.ends_at?h(new Date(e.ends_at),"dd MMM yyyy"):"-"})]})]})},ve=()=>{const{id:e}=M(),t=A(),{gift_card:i,isLoading:r,isError:n,error:c}=z(e,{initialData:t});if(r||!i)return null;if(n)throw c;return s.jsxs("div",{className:"flex flex-col gap-y-2",children:[s.jsx(J,{giftCard:i}),s.jsx($,{data:i}),s.jsx(E,{})]})},V=e=>({queryKey:P.detail(e),queryFn:async()=>S.admin.giftCards.retrieve(e)}),we=async({params:e})=>{const t=e.id,i=V(t);return f.getQueryData(i.queryKey)??await f.fetchQuery(i)};export{ve as Component,we as loader};

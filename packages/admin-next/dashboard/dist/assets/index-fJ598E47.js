import{u as l,j as t,a1 as j,T as x,ap as A,aM as R,Z as g,W as q}from"./index-S--WvUSo.js";import{J as I}from"./json-view-section-Dui2O31i.js";import{d as E,b as N,e as z}from"./collections-1ZxhMSyG.js";import{A as m}from"./action-menu-olZwXQ3q.js";import{P as y}from"./pencil-square-u3fizEAQ.js";import{T as P}from"./trash-nTjeUaCp.js";import{u as d}from"./use-prompt-wB0F2CxI.js";import{H as b}from"./heading-cSlef4Su.js";import{r as L}from"./react-PzSkSLoa.js";import{a as Q,D as _}from"./use-data-table-TeZp00wg.js";import{f as H}from"./products-_PEbH1CR.js";import{u as O,a as W,b as K}from"./use-product-table-columns-k99B-kCF.js";import{P as M}from"./plus-U36vXkkF.js";import{C as f}from"./checkbox-8MlXzZCx.js";import{c as Y}from"./index-JDlOzmVl.js";import{d as $,c as F,j as G,O as J}from"./react-router-dom-aSYyayiN.js";import"./react-dom-Og6--24v.js";import"./badge-99FyByJO.js";import"./drawer-H3TI1lDZ.js";import"./index-sF0hA49A.js";import"./x-mark-mini-aYDSd38M.js";import"./prompt-LzbVPZYR.js";import"./button-Pc5Xo8ua.js";import"./input-A29ux7yj.js";import"./label-HFq5fzpT.js";import"./empty-table-content-i72rBIA2.js";import"./plus-mini-IRJECoWI.js";import"./index-1Zwdg31z.js";import"./use-date-Putn0_Ur.js";import"./format-vrL-wy9v.js";import"./date-picker-s8-9mila.js";import"./minus-E5-czcFC.js";import"./index-7dV3TD85.js";import"./index-Hm2Uj9Gg.js";import"./lodash-5s15_I2H.js";import"./command-bar-wUgfUfvQ.js";import"./product-types-gZDu6wo-.js";import"./sales-channels--fho5-f4.js";import"./placeholder-cell-O6UVTGmQ.js";import"./product-cell-gRltbXZC.js";import"./thumbnail-gerN888-.js";import"./status-cell-9XExsAIG.js";import"./tooltip-Ixyw9oT8.js";const Z=({collection:s})=>{const{t:e}=l(),o=d(),{mutateAsync:r}=E(s.id),a=async()=>{await o({title:e("general.areYouSure"),description:e("collections.deleteWarning",{count:1})})&&await r()};return t.jsxs(j,{className:"divide-y p-0",children:[t.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[t.jsx(b,{children:s.title}),t.jsx(m,{groups:[{actions:[{icon:t.jsx(y,{}),label:e("actions.edit"),to:`/collections/${s.id}/edit`}]},{actions:[{icon:t.jsx(P,{}),label:e("actions.delete"),onClick:a}]}]})]}),t.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[t.jsx(x,{size:"small",leading:"compact",weight:"plus",children:e("fields.handle")}),t.jsxs(x,{size:"small",children:["/",s.handle]})]})]})},c=10,B=({collection:s})=>{const{t:e}=l(),{searchParams:o,raw:r}=O({pageSize:c}),{products:a,count:i,isLoading:u,isError:C,error:v}=H({limit:c,...o,collection_id:[s.id]},{placeholderData:A}),w=W(["collections"]),p=U(),{table:S}=Q({data:a??[],columns:p,getRowId:n=>n.id,count:i,enablePagination:!0,enableRowSelection:!0,pageSize:c,meta:{collectionId:s.id}}),T=d(),k=async n=>{const D=Object.keys(n);await T({title:e("general.areYouSure"),description:e("collections.removeProductsWarning",{count:D.length}),confirmText:e("actions.remove"),cancelText:e("actions.cancel")})};if(C)throw v;return t.jsxs(j,{className:"divide-y p-0",children:[t.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[t.jsx(b,{level:"h2",children:e("products.domain")}),t.jsx(m,{groups:[{actions:[{icon:t.jsx(M,{}),label:e("actions.add"),to:"products"}]}]})]}),t.jsx(_,{table:S,columns:p,search:!0,pagination:!0,pageSize:c,navigateTo:({original:n})=>`/products/${n.id}`,count:i,filters:w,isLoading:u,orderBy:["title","created_at","updated_at"],queryObject:r,commands:[{action:k,label:e("actions.remove"),shortcut:"r"}]})]})},V=({product:s,collectionId:e})=>{const{t:o}=l(),r=d(),{mutateAsync:a}=R(e),i=async()=>{await r({title:o("general.areYouSure"),description:o("collections.removeSingleProductWarning",{title:s.title}),confirmText:o("actions.remove"),cancelText:o("actions.cancel")})&&await a({product_ids:[s.id]})};return t.jsx(m,{groups:[{actions:[{icon:t.jsx(y,{}),label:o("actions.edit"),to:`/products/${s.id}/edit`}]},{actions:[{icon:t.jsx(P,{}),label:o("actions.remove"),onClick:i}]}]})},h=Y(),U=()=>{const s=K();return L.useMemo(()=>[h.display({id:"select",header:({table:e})=>t.jsx(f,{checked:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),onCheckedChange:o=>e.toggleAllPageRowsSelected(!!o)}),cell:({row:e})=>t.jsx(f,{checked:e.getIsSelected(),onCheckedChange:o=>e.toggleSelected(!!o),onClick:o=>{o.stopPropagation()}})}),...s,h.display({id:"actions",cell:({row:e,table:o})=>{const{collectionId:r}=o.options.meta;return t.jsx(V,{product:e.original,collectionId:r})}})],[s])},Ye=()=>{const s=$(),{id:e}=F(),{collection:o,isLoading:r,isError:a,error:i}=N(e,{initialData:s});if(r)return t.jsx("div",{children:"Loading..."});if(a||!o)throw i||G("An unknown error occurred",500);return t.jsxs("div",{className:"flex flex-col gap-y-2",children:[t.jsx(Z,{collection:o}),t.jsx(B,{collection:o}),t.jsx(I,{data:o}),t.jsx(J,{})]})},X=s=>({queryKey:z.detail(s),queryFn:async()=>q.collections.retrieve(s)}),$e=async({params:s})=>{const e=s.id,o=X(e);return g.getQueryData(o.queryKey)??await g.fetchQuery(o)};export{Ye as Component,$e as loader};

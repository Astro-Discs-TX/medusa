import{Z as S,aO as L,W as A,at as w,u as f,j as e,a1 as _,ap as I,T as n,an as q}from"./index-S--WvUSo.js";import{J as O}from"./json-view-section-Dui2O31i.js";import{r as P}from"./react-PzSkSLoa.js";import{A as h}from"./action-menu-olZwXQ3q.js";import{a as E,D as B}from"./use-data-table-TeZp00wg.js";import{u as H}from"./currencies--m0OMbks.js";import{u as Q,a as W}from"./use-currencies-table-query-HIAX2jYr.js";import{P as Y}from"./plus-U36vXkkF.js";import{t as p}from"./toast-4oQfF9Sm.js";import{T as G}from"./trash-nTjeUaCp.js";import{u as T}from"./use-prompt-wB0F2CxI.js";import{H as D}from"./heading-cSlef4Su.js";import{C as d}from"./command-bar-wUgfUfvQ.js";import{C as v}from"./checkbox-8MlXzZCx.js";import{c as J}from"./index-JDlOzmVl.js";import{b as K}from"./regions-en8xSoIX.js";import{P as M}from"./pencil-square-u3fizEAQ.js";import{B as U}from"./badge-99FyByJO.js";import{d as V,O as Z}from"./react-router-dom-aSYyayiN.js";import"./react-dom-Og6--24v.js";import"./drawer-H3TI1lDZ.js";import"./index-sF0hA49A.js";import"./x-mark-mini-aYDSd38M.js";import"./empty-table-content-i72rBIA2.js";import"./plus-mini-IRJECoWI.js";import"./button-Pc5Xo8ua.js";import"./index-1Zwdg31z.js";import"./use-date-Putn0_Ur.js";import"./format-vrL-wy9v.js";import"./date-picker-s8-9mila.js";import"./input-A29ux7yj.js";import"./minus-E5-czcFC.js";import"./index-7dV3TD85.js";import"./index-Hm2Uj9Gg.js";import"./lodash-5s15_I2H.js";import"./label-HFq5fzpT.js";import"./information-circle-solid-rXH6vJ5W.js";import"./x-circle-solid-rnqhxvfk.js";import"./check-circle-solid-7j4QonPK.js";import"./prompt-LzbVPZYR.js";const F=()=>({queryKey:L.details(),queryFn:async()=>A.stores.retrieve()}),Ye=async()=>{const r=F();return S.getQueryData(r.queryKey)??await S.fetchQuery(r)},y=10,X=({store:r})=>{const[s,t]=P.useState({}),{searchParams:i,raw:c}=Q({pageSize:y}),{currencies:o,count:m,isPending:g,isError:j,error:l}=H({code:r.supported_currency_codes,...i},{placeholderData:I}),C=ee(),{table:R}=E({data:o??[],columns:C,count:m,getRowId:u=>u.code,rowSelection:{state:s,updater:t},enablePagination:!0,enableRowSelection:!0,pageSize:y,meta:{storeId:r.id,currencyCodes:r.supported_currency_codes,defaultCurrencyCode:r.default_currency_code}}),{mutateAsync:k}=w(r.id),{t:a}=f(),z=T(),N=async()=>{const u=Object.keys(s);if(await z({title:a("general.areYouSure"),description:a("store.removeCurrencyWarning",{count:u.length}),confirmText:a("actions.remove"),cancelText:a("actions.cancel")}))try{await k({supported_currency_codes:r.supported_currency_codes.filter(x=>!u.includes(x))}),t({}),p.success(a("general.success"),{description:a("store.toast.currenciesRemoved"),dismissLabel:a("actions.close")})}catch(x){p.error(a("general.error"),{description:x.message,dismissLabel:a("actions.close")})}};if(j)throw l;return e.jsxs(_,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(D,{level:"h2",children:a("store.currencies")}),e.jsx(h,{groups:[{actions:[{icon:e.jsx(Y,{}),label:a("actions.add"),to:"currencies"}]}]})]}),e.jsx(B,{orderBy:["code","name"],search:!0,pagination:!0,table:R,pageSize:y,columns:C,count:m,isLoading:g,queryObject:c}),e.jsx(d,{open:!!Object.keys(s).length,children:e.jsxs(d.Bar,{children:[e.jsx(d.Value,{children:a("general.countSelected",{count:Object.keys(s).length})}),e.jsx(d.Seperator,{}),e.jsx(d.Command,{action:N,shortcut:"r",label:a("actions.remove")})]})})]})},$=({storeId:r,currency:s,currencyCodes:t,defaultCurrencyCode:i})=>{const{mutateAsync:c}=w(r),{t:o}=f(),m=T(),g=async()=>{if(await m({title:o("general.areYouSure"),description:o("store.removeCurrencyWarning",{count:1}),verificationInstruction:o("general.typeToConfirm"),verificationText:s.name,confirmText:o("actions.remove"),cancelText:o("actions.cancel")}))try{await c({supported_currency_codes:t.filter(l=>l!==s.code)}),p.success(o("general.success"),{description:o("store.toast.currenciesRemoved"),dismissLabel:o("actions.close")})}catch(l){p.error(o("general.error"),{description:l.message,dismissLabel:o("actions.close")})}};return e.jsx(h,{groups:[{actions:[{icon:e.jsx(G,{}),label:o("actions.remove"),onClick:g,disabled:s.code===i}]}]})},b=J(),ee=()=>{const r=W();return P.useMemo(()=>[b.display({id:"select",header:({table:s})=>e.jsx(v,{checked:s.getIsSomePageRowsSelected()?"indeterminate":s.getIsAllPageRowsSelected(),onCheckedChange:t=>s.toggleAllPageRowsSelected(!!t)}),cell:({row:s})=>e.jsx(v,{checked:s.getIsSelected(),onCheckedChange:t=>s.toggleSelected(!!t),onClick:t=>{t.stopPropagation()}})}),...r,b.display({id:"actions",cell:({row:s,table:t})=>{const{currencyCodes:i,storeId:c,defaultCurrencyCode:o}=t.options.meta;return e.jsx($,{storeId:c,currency:s.original,currencyCodes:i,defaultCurrencyCode:o})}})],[r])},se=({store:r})=>{const{t:s}=f(),{region:t}=K(r.default_region_id,void 0,{enabled:!!r.default_region_id});return e.jsxs(_,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsxs("div",{children:[e.jsx(D,{children:s("store.domain")}),e.jsx(n,{className:"text-ui-fg-subtle",size:"small",children:s("store.manageYourStoresDetails")})]}),e.jsx(h,{groups:[{actions:[{icon:e.jsx(M,{}),label:s("actions.edit"),to:"edit"}]}]})]}),e.jsxs("div",{className:"grid grid-cols-2 px-6 py-4",children:[e.jsx(n,{size:"small",leading:"compact",weight:"plus",children:s("fields.name")}),e.jsx(n,{size:"small",leading:"compact",children:r.name})]}),r.default_currency&&e.jsxs("div",{className:"grid grid-cols-2 px-6 py-4",children:[e.jsx(n,{size:"small",leading:"compact",weight:"plus",children:s("store.defaultCurrency")}),e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(U,{size:"2xsmall",children:r.default_currency.code.toUpperCase()}),e.jsx(n,{size:"small",leading:"compact",children:r.default_currency.name})]})]}),t&&e.jsxs("div",{className:"grid grid-cols-2 px-6 py-4",children:[e.jsx(n,{size:"small",leading:"compact",weight:"plus",children:s("store.defaultRegion")}),e.jsx("div",{className:"flex items-center gap-x-2",children:e.jsx(n,{size:"small",leading:"compact",children:t.name})})]})]})},Ge=()=>{const r=V(),{store:s,isPending:t,isError:i,error:c}=q({initialData:r});if(t||!s)return e.jsx("div",{children:"Loading..."});if(i)throw c;return e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsx(se,{store:s}),e.jsx(X,{store:s}),e.jsx(O,{data:s}),e.jsx(Z,{})]})};export{Ge as Component,Ye as loader};

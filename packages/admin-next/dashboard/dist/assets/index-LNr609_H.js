import{u as D,j as e,ap as I}from"./index-S--WvUSo.js";import{u as A,a as i}from"./route-focus-modal-MMx5Xnk0.js";import{r as u}from"./react-PzSkSLoa.js";import{o as F,a as B,s as M}from"./index-JzuMwgWW.js";import{t as H}from"./zod-jt04JUtm.js";import{u as N}from"./form-0PHaH8g8.js";import{a as O,D as V}from"./use-data-table-TeZp00wg.js";import{u as q,a as G}from"./use-sales-channel-table-query-O9OBIAwF.js";import{u as Q}from"./use-sales-channel-table-filters-MNsQPVv0.js";import{u as U}from"./sales-channels--fho5-f4.js";import{d as Z,a as $}from"./stock-locations-5f5MPAbM.js";import{B as _}from"./button-Pc5Xo8ua.js";import{C as x}from"./checkbox-8MlXzZCx.js";import{c as J}from"./index-JDlOzmVl.js";import{c as K}from"./react-router-dom-aSYyayiN.js";import"./react-dom-Og6--24v.js";import"./drawer-H3TI1lDZ.js";import"./index-sF0hA49A.js";import"./heading-cSlef4Su.js";import"./prompt-LzbVPZYR.js";import"./information-circle-solid-rXH6vJ5W.js";import"./label-HFq5fzpT.js";import"./tooltip-Ixyw9oT8.js";import"./empty-table-content-i72rBIA2.js";import"./plus-mini-IRJECoWI.js";import"./index-1Zwdg31z.js";import"./use-date-Putn0_Ur.js";import"./format-vrL-wy9v.js";import"./date-picker-s8-9mila.js";import"./input-A29ux7yj.js";import"./minus-E5-czcFC.js";import"./x-mark-mini-aYDSd38M.js";import"./index-7dV3TD85.js";import"./index-Hm2Uj9Gg.js";import"./lodash-5s15_I2H.js";import"./command-bar-wUgfUfvQ.js";import"./status-cell-9XExsAIG.js";import"./text-cell-OtkuJsO8.js";import"./placeholder-cell-O6UVTGmQ.js";import"./products-_PEbH1CR.js";const W=F({sales_channels:B(M()).optional()}),d=50,X=({location:o})=>{var f,g;const{t:s}=D(),{handleSuccess:a}=A(),n=N({defaultValues:{sales_channels:((f=o.sales_channels)==null?void 0:f.map(t=>t.id))??[]},resolver:H(W)}),{setValue:l}=n,C=((g=o.sales_channels)==null?void 0:g.reduce((t,c)=>(t[c.id]=!0,t),{}))??{},[m,j]=u.useState(C);u.useEffect(()=>{const t=Object.keys(m);l("sales_channels",t,{shouldDirty:!0,shouldTouch:!0})},[m,l]);const{searchParams:y,raw:b}=q({pageSize:d}),{sales_channels:k,count:p,isLoading:v,isError:w,error:P}=U({...y},{placeholderData:I}),z=Q(),h=ee(),{table:T}=O({data:k??[],columns:h,count:p,enablePagination:!0,enableRowSelection:!0,rowSelection:{state:m,updater:j},getRowId:t=>t.id,pageSize:d}),{mutateAsync:E,isPending:R}=Z(o.id),L=n.handleSubmit(async t=>{const c=o.sales_channels.map(r=>r.id),S=t.sales_channels??[];await E({add:S.filter(r=>!c.includes(r)),remove:c.filter(r=>!S.includes(r))},{onSuccess:()=>{a()}})});if(w)throw P;return e.jsx(i.Form,{form:n,children:e.jsxs("div",{className:"flex h-full flex-col overflow-hidden",children:[e.jsx(i.Header,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(i.Close,{asChild:!0,children:e.jsx(_,{size:"small",variant:"secondary",children:s("actions.cancel")})}),e.jsx(_,{size:"small",isLoading:R,onClick:L,children:s("actions.save")})]})}),e.jsx(i.Body,{children:e.jsx(V,{table:T,columns:h,pageSize:d,isLoading:v,count:p,filters:z,search:!0,pagination:!0,orderBy:["name","created_at","updated_at"],queryObject:b,layout:"fill"})})]})})},Y=J(),ee=()=>{const o=G();return u.useMemo(()=>[Y.display({id:"select",header:({table:s})=>e.jsx(x,{checked:s.getIsSomePageRowsSelected()?"indeterminate":s.getIsAllPageRowsSelected(),onCheckedChange:a=>s.toggleAllPageRowsSelected(!!a)}),cell:({row:s})=>e.jsx(x,{checked:s.getIsSelected(),onCheckedChange:a=>s.toggleSelected(!!a),onClick:a=>{a.stopPropagation()}})}),...o],[o])},Oe=()=>{const{location_id:o}=K(),{stock_location:s={},isPending:a,isError:n,error:l}=$(o,{fields:"name,*sales_channels,address.city,address.country_code,fulfillment_sets.type,fulfillment_sets.name,*fulfillment_sets.service_zones.geo_zones,*fulfillment_sets.service_zones,*fulfillment_sets.service_zones.shipping_options,*fulfillment_sets.service_zones.shipping_options.shipping_profile"});if(n)throw l;return e.jsx(i,{children:!a&&s&&e.jsx(X,{location:s})})};export{Oe as Component};

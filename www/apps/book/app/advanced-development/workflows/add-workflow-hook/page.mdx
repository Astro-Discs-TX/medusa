export const metadata = {
  title: `${pageNumber} Workflow Hooks`,
}

# {metadata.title}

In this chapter, you'll learn what a workflow hook is, how to add it to your workflow, and how to add workflow hook handlers.

## What is a Workflow Hook?

A workflow hook is a point in a workflow where you can inject a step function, called a hook handler.

Hook handlers receive an input from the workflow to perform an action using them. They are executed during the workflow's execution when it reaches the hook.

<Note title="Use workflow hooks when" type="success">

- Your workflow is reusable in other applications and you allow performing an external action at some point in your workflow.

</Note>

<Note title="Don't use workflow hooks if" type="error">

- Your workflow isn't reusable by other application. Use a step that performs what a hook handler would instead.

</Note>

---

## How to Add a Hook in a Workflow?

To add a hook in your workflow, use the `createHook` function imported from `@medusajs/workflows-sdk`.

For example:

export const hookHighlights = [
  ["13", "createHook", "Add a hook to the workflow."],
  ["14", `"productCreated"`, "The hook's name."],
  ["15", "productId", "The data to pass to the hook handler."],
  ["19", "hooks", "Return the list of hooks in the workflow."]
]

```ts title="src/workflows/my-workflow/index.ts" highlights={hookHighlights}
import {
  createStep,
  createHook,
  createWorkflow,
  WorkflowResponse,
} from "@medusajs/workflows-sdk"
import { createProductStep } from "./steps/create-product"

export const myWorkflow = createWorkflow(
  "my-workflow", 
  function (input) {
    const product = createProductStep(input)
    const productCreatedHook = createHook(
      "productCreated", 
      { productId: product.id }
    )

    return new WorkflowResponse(product, {
      hooks: [productCreatedHook],
    })
  }
)
```

The `createHook` function accepts two parameters:

1. The first is a string indicating the hook's name. This is used to add a hook handler later.
2. The second is the input to pass to the hook handler.

The workflow must also return as a second parameter of `WorkflowResponse` an object having a `hooks` property. Its value is an array of the workflow's hooks.

---

## How to Add a Hook Handler?

Hook handlers are created in the `src/workflows/hooks` directory. They use the workflow's `hooks` property to add a hook handler.

For example, to add a hook handler to the workflow in the previous example, create the file `src/workflows/hooks/my-workflow.ts` with the following content:

export const handlerHighlights = [
  ["3", "productCreated", "Invoke the hook, passing it a step function as a parameter."],
]

```ts title="src/workflows/hooks/my-workflow.ts" highlights={handlerHighlights}
import { myWorkflow } from "../my-workflow"

myWorkflow.hooks.productCreated(
  async ({ productId }, { container }) => {
    // TODO perform an action
  }
)
```

<Note>

A hook can have only one handler.

</Note>

The hook is available on the workflow's `hooks` property using its name `productCreated`. You invoke the hook passing the handler as a parameter, which is a step function.

Similar to a step, the handler receives the hook's input as a first parameter, and the container in the object as a second parameter.

### Hook Handler Compensation

You can also pass a compensation function as a second parameter:

```ts
import { myWorkflow } from "../my-workflow"

myWorkflow.hooks.productCreated(
  async ({ productId }, { container }) => {
    // TODO perform an action
  },
  async () => {
    // undo the performed action
  }
)
```

The compensation function is executed if an error occurs in the workflow to undo the actions performed by the hook handler.